XOOPSCube Legacy (XCL) is a Web Application Platform (WAP) and Content Management System (CMS) designed for building websites and web applications. It is built on PHP with MySQL database support, following a modular architecture that allows for extension through modules, themes, and plugins. This document provides a technical overview of the XCL system architecture, core components, and key subsystems.

## System Architecture

XOOPSCube Legacy follows a modular design pattern with a clear separation between core components, the module system, theme rendering, and service layers.
XOOPSCube Legacy follows a layered architecture with a clear separation between the core XCube framework, the Legacy compatibility layer, and module-specific functionality:


<div class="panzoom-schema">
<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-cbtmxw8dr0s" width="100%" aria-roledescription="flowchart-v2" class="flowchart" style="max-width:2992.43115234375px" viewBox="0 0 2992.431 1205"><defs/><style>@keyframes edge-animation-frame{0%{stroke-dashoffset:0}}@keyframes dash{to{stroke-dashoffset:0}}#mermaid-cbtmxw8dr0s{font-family:sans-serif;font-size:16px;}#mermaid-cbtmxw8dr0s .edge-thickness-normal{stroke-width:1px}#mermaid-cbtmxw8dr0s .edge-pattern-solid{stroke-dasharray:0}#mermaid-cbtmxw8dr0s .marker{fill:#999;stroke:#999}#mermaid-cbtmxw8dr0s .marker.cross{stroke:#999}#mermaid-cbtmxw8dr0s .label,#mermaid-cbtmxw8dr0s svg{font-family:sans-serif}#mermaid-cbtmxw8dr0s svg{font-size:16px}#mermaid-cbtmxw8dr0s p{margin:0}#mermaid-cbtmxw8dr0s .label{color:#333}#mermaid-cbtmxw8dr0s .cluster span,#mermaid-cbtmxw8dr0s .cluster-label span{color:#fff}#mermaid-cbtmxw8dr0s .cluster-label span p{background-color:transparent}#mermaid-cbtmxw8dr0s span{fill:#fff;color:#fff}#mermaid-cbtmxw8dr0s .node circle,#mermaid-cbtmxw8dr0s .node path,#mermaid-cbtmxw8dr0s .node rect{fill:#212745!important;stroke:#face74!important;stroke-width:1px}#mermaid-cbtmxw8dr0s .node .label{text-align:center}#mermaid-cbtmxw8dr0s .flowchart-link{stroke:#999;fill:none}#mermaid-cbtmxw8dr0s .edgeLabel{background-color:#0d0f1c;text-align:center}#mermaid-cbtmxw8dr0s .edgeLabel p{background-color:#0d0f1c}#mermaid-cbtmxw8dr0s .edgeLabel rect{opacity:.5;background-color:#0d0f1c;fill:#fff}#mermaid-cbtmxw8dr0s .labelBkg{background-color:rgba(255,255,255,.5)}#mermaid-cbtmxw8dr0s .cluster path{fill:#121727;stroke:#5c6bc0;stroke-width:1px}#mermaid-cbtmxw8dr0s :root{--mermaid-font-family:sans-serif}</style><marker id="mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd" class="marker flowchart-v2" markerHeight="8" markerUnits="userSpaceOnUse" markerWidth="8" orient="auto" refX="5" refY="5" viewBox="0 0 10 10"><path d="m0 0 10 5-10 5z" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><marker id="mermaid-cbtmxw8dr0s_flowchart-v2-pointStart" class="marker flowchart-v2" markerHeight="8" markerUnits="userSpaceOnUse" markerWidth="8" orient="auto" refX="4.5" refY="5" viewBox="0 0 10 10"><path d="m0 5 10 5V0z" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><marker id="mermaid-cbtmxw8dr0s_flowchart-v2-circleEnd" class="marker flowchart-v2" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="11" refY="5" viewBox="0 0 10 10"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><marker id="mermaid-cbtmxw8dr0s_flowchart-v2-circleStart" class="marker flowchart-v2" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="-1" refY="5" viewBox="0 0 10 10"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><marker id="mermaid-cbtmxw8dr0s_flowchart-v2-crossEnd" class="marker cross flowchart-v2" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="12" refY="5.2" viewBox="0 0 11 11"><use xlink:href="#reuse-0" class="arrowMarkerPath" style="stroke-width:2;stroke-dasharray:1,0"/></marker><marker id="mermaid-cbtmxw8dr0s_flowchart-v2-crossStart" class="marker cross flowchart-v2" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="-1" refY="5.2" viewBox="0 0 11 11"><use xlink:href="#reuse-0" class="arrowMarkerPath" style="stroke-width:2;stroke-dasharray:1,0"/></marker><g class="root"><g class="clusters"><g id="subGraph4" class="cluster" data-look="classic"><path d="M8 731h676.628v337H8z"/><foreignObject width="108.988" height="24" class="cluster-label" transform="translate(291.82 731)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Module System</p></span></div></foreignObject></g><g id="subGraph3" class="cluster" data-look="classic"><path d="M1696.028 731h290.913v466h-290.913z"/><foreignObject width="131.425" height="24" class="cluster-label" transform="translate(1775.772 731)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Data Management</p></span></div></foreignObject></g><g id="subGraph2" class="cluster" data-look="classic"><path d="M2109.481 731h874.95v337h-874.95z"/><foreignObject width="104.4" height="24" class="cluster-label" transform="translate(2494.756 731)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Render System</p></span></div></foreignObject></g><g id="subGraph1" class="cluster" data-look="classic"><path d="M704.628 577h870.444v362H704.628z"/><foreignObject width="103.113" height="24" class="cluster-label" transform="translate(1088.294 577)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy System</p></span></div></foreignObject></g><g id="subGraph0" class="cluster" data-look="classic"><path d="M1595.072 136h989.253v545h-989.253z"/><foreignObject width="83.588" height="24" class="cluster-label" transform="translate(2047.905 136)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube Core</p></span></div></foreignObject></g></g><g class="edgePaths"><path id="L_Client_MainFile_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m2178.134 60.617-20.136 6.398c-20.137 6.397-60.409 19.191-80.546 31.755-20.136 12.563-20.136 24.897-20.136 34.563V157" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_MainFile_CoreInit_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M2057.316 215v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_CoreInit_XCubeRoot_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M2057.316 319v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XCubeRoot_XCubeController_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1984.359 407.317-43.708 6.781c-43.709 6.78-131.127 20.341-174.836 30.622-43.709 10.28-43.709 17.28-43.709 20.78v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XCubeController_Delegates_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1813.613 510.253 62.096 6.958c62.097 6.958 186.291 20.873 248.388 31.998 62.097 11.124 62.097 19.458 62.097 27.124V598" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XCubeRoot_SessionManager_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1999.676 423-8.895 4.167c-8.895 4.166-26.685 12.5-35.58 20.166-8.895 7.667-8.895 14.667-8.895 18.167v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XCubeRoot_LanguageManager_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m2130.272 422.328 11.857 4.278c11.856 4.279 35.57 12.837 47.427 20.615 11.857 7.779 11.857 14.779 11.857 18.279v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XCubeRoot_TextFilter_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m2130.272 405.384 55.217 7.103c55.217 7.103 165.652 21.308 220.869 31.91C2461.575 455 2461.575 462 2461.575 465.5v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XCubeController_LegacyController_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M1722.106 527v25c0 8.333 0 16.667-52.651 27.468-52.651 10.801-157.953 24.069-210.604 30.704l-52.651 6.634" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_LegacyController_ControllerStrategy_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1216.619 644.194-37.468 6.135c-37.469 6.134-112.405 18.402-149.873 28.703-37.469 10.301-37.469 18.635-37.469 26.968v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_ControllerStrategy_AdminStrategy_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m936.19 810-8.583 4.167c-8.583 4.166-25.75 12.5-34.333 20.166-8.583 7.667-8.583 14.667-8.583 18.167v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_ControllerStrategy_PublicStrategy_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1088.222 801.951 28.022 5.508c28.022 5.509 84.065 16.525 112.087 25.533 28.022 9.008 28.022 16.008 28.022 19.508v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_LegacyController_TextFilter2_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1266.772 656-6.582 4.167c-6.583 4.166-19.747 12.5-26.33 20.833-6.582 8.333-6.582 16.667-6.582 25v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_LegacyController_ModuleContext_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1384.079 656 11.521 4.167c11.52 4.166 34.562 12.5 46.082 20.833 11.521 8.333 11.521 16.667 11.521 25v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_LegacyController_RenderSystem_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1402.231 648.646 25.474 5.392c25.473 5.393 76.42 16.177 101.893 25.736 25.474 9.559 25.474 17.893 25.474 26.226 0 8.333 0 16.667 156.272 28.578 156.272 11.911 468.817 27.401 625.089 35.146l156.272 7.744" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_RenderSystem_AdminRenderSystem_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m2496.7 800.011-36.895 5.831c-36.895 5.832-110.684 17.495-147.579 26.826-36.895 9.332-36.895 16.332-36.895 19.832v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_RenderSystem_ThemeRenderSystem_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m2595.735 810-1.326 4.167c-1.325 4.166-3.977 12.5-5.302 20.166-1.326 7.667-1.326 14.667-1.326 18.167v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_RenderSystem_XoopsTpl_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m2711.95 804.94 24.576 5.01c24.576 5.01 73.728 15.03 98.304 23.54 24.576 8.51 24.576 15.51 24.576 19.01v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_XoopsTpl_Templates_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M2859.406 914v71" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_LegacyController_DBConnection_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1402.231 650.387 22.14 5.102c22.14 5.102 66.421 15.307 88.561 24.576 22.14 9.268 22.14 17.602 22.14 25.935 0 8.333 0 16.667 32.837 26.406 32.838 9.739 98.513 20.885 131.35 26.458l32.838 5.572" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_DBConnection_DatabaseFactory_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M1841.484 810v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_DatabaseFactory_MySQLDatabase_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M1841.484 914v71" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_MySQLDatabase_Database_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M1841.484 1043v71" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_LegacyController_ModuleHandler_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m1216.619 638.375-70.327 7.104c-70.326 7.104-210.979 21.313-281.306 32.583-70.327 11.271-70.327 19.605-70.327 27.938 0 8.333 0 16.667-57.467 27.385-57.468 10.719-172.404 23.823-229.872 30.375l-57.468 6.552" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_ModuleHandler_Module_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M338.566 810v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_Module_UserModule_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m273.109 902.452-25.804 6.091c-25.805 6.091-77.414 18.274-103.219 28.532-25.805 10.258-25.805 18.592-25.805 26.258V985" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_Module_LegacyModule_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m332.706 914-.904 4.167c-.904 4.166-2.712 12.5-3.617 20.833-.904 8.333-.904 16.667-.904 24.333V985" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_Module_CustomModules_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="m404.022 903.024 24.493 5.996c24.493 5.996 73.48 17.988 97.973 28.151 24.493 10.162 24.493 18.496 24.493 26.162V985" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_RenderSystem_Client_0" marker-end="url(#mermaid-cbtmxw8dr0s_flowchart-v2-pointEnd)" d="M2604.325 756V138.5c0-14.833 0-27.167-43.497-41.389-43.497-14.223-130.491-30.335-173.988-38.392l-43.498-8.056" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="98.313" height="24" class="label" transform="translate(2008.16 87)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>HTTP Request</p></span></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g></g><g class="nodes"><g id="flowchart-Client-0" class="node default"><path d="M-80.638-27H80.637v54H-80.638z" class="basic label-container" transform="translate(2258.772 35)"/><g class="label" transform="translate(2208.134 23)"><rect/><foreignObject width="101.275" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Client Browser</p></span></div></foreignObject></g></g><g id="flowchart-MainFile-1" class="node default"><path d="M-73.656-27H73.657v54H-73.656z" class="basic label-container" transform="translate(2057.316 188)"/><g class="label" transform="translate(2013.66 176)"><rect/><foreignObject width="87.313" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>mainfile.php</p></span></div></foreignObject></g></g><g id="flowchart-CoreInit-3" class="node default"><path d="M-92.563-27H92.562v54H-92.563z" class="basic label-container" transform="translate(2057.316 292)"/><g class="label" transform="translate(1994.753 280)"><rect/><foreignObject width="125.125" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>cubecore_init.php</p></span></div></foreignObject></g></g><g id="flowchart-XCubeRoot-5" class="node default"><path d="M-72.956-27H72.956v54H-72.956z" class="basic label-container" transform="translate(2057.316 396)"/><g class="label" transform="translate(2014.36 384)"><rect/><foreignObject width="85.912" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_Root</p></span></div></foreignObject></g></g><g id="flowchart-XCubeController-7" class="node default"><path d="M-91.506-27H91.507v54H-91.506z" class="basic label-container" transform="translate(1722.106 500)"/><g class="label" transform="translate(1660.6 488)"><rect/><foreignObject width="123.013" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_Controller</p></span></div></foreignObject></g></g><g id="flowchart-Delegates-9" class="node default"><path d="M-115.169-27h230.338v54h-230.338z" class="basic label-container" transform="translate(2186.194 629)"/><g class="label" transform="translate(2101.025 617)"><rect/><foreignObject width="170.338" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_Delegate System</p></span></div></foreignObject></g></g><g id="flowchart-SessionManager-11" class="node default"><path d="M-82.694-27H82.694v54H-82.694z" class="basic label-container" transform="translate(1946.306 500)"/><g class="label" transform="translate(1893.613 488)"><rect/><foreignObject width="105.388" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_Session</p></span></div></foreignObject></g></g><g id="flowchart-LanguageManager-13" class="node default"><path d="M-122.412-27h244.825v54h-244.825z" class="basic label-container" transform="translate(2201.413 500)"/><g class="label" transform="translate(2109 488)"><rect/><foreignObject width="184.825" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_LanguageManager</p></span></div></foreignObject></g></g><g id="flowchart-TextFilter-15" class="node default"><path d="M-87.75-27h175.5v54h-175.5z" class="basic label-container" transform="translate(2461.575 500)"/><g class="label" transform="translate(2403.825 488)"><rect/><foreignObject width="115.5" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_TextFilter</p></span></div></foreignObject></g></g><g id="flowchart-LegacyController-17" class="node default"><path d="M-92.806-27H92.807v54H-92.806z" class="basic label-container" transform="translate(1309.425 629)"/><g class="label" transform="translate(1246.619 617)"><rect/><foreignObject width="125.613" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_Controller</p></span></div></foreignObject></g></g><g id="flowchart-ControllerStrategy-19" class="node default"><path d="M-96.412-27H96.413v54H-96.412z" class="basic label-container" transform="translate(991.81 783)"/><g class="label" transform="translate(925.397 771)"><rect/><foreignObject width="132.825" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Controller Strategy</p></span></div></foreignObject></g></g><g id="flowchart-AdminStrategy-21" class="node default"><path d="M-145.063-27h290.125v54h-290.125z" class="basic label-container" transform="translate(884.69 887)"/><g class="label" transform="translate(769.628 875)"><rect/><foreignObject width="230.125" height="24"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Legacy_AdminControllerStrategy</p></span></div></foreignObject></g></g><g id="flowchart-PublicStrategy-23" class="node default"><path d="M-143.119-27h286.238v54h-286.238z" class="basic label-container" transform="translate(1256.353 887)"/><g class="label" transform="translate(1143.234 875)"><rect/><foreignObject width="226.238" height="24"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Legacy_PublicControllerStrategy</p></span></div></foreignObject></g></g><g id="flowchart-TextFilter2-25" class="node default"><path d="M-89.056-27H89.057v54H-89.056z" class="basic label-container" transform="translate(1227.278 783)"/><g class="label" transform="translate(1168.222 771)"><rect/><foreignObject width="118.113" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_TextFilter</p></span></div></foreignObject></g></g><g id="flowchart-ModuleContext-27" class="node default"><path d="M-86.869-27H86.869v54H-86.869z" class="basic label-container" transform="translate(1453.203 783)"/><g class="label" transform="translate(1396.334 771)"><rect/><foreignObject width="113.738" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Module Context</p></span></div></foreignObject></g></g><g id="flowchart-RenderSystem-29" class="node default"><path d="M-107.625-27h215.25v54h-215.25z" class="basic label-container" transform="translate(2604.325 783)"/><g class="label" transform="translate(2526.7 771)"><rect/><foreignObject width="155.25" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_RenderSystem</p></span></div></foreignObject></g></g><g id="flowchart-AdminRenderSystem-31" class="node default"><path d="M-130.85-27h261.7v54h-261.7z" class="basic label-container" transform="translate(2275.331 887)"/><g class="label" transform="translate(2174.481 875)"><rect/><foreignObject width="201.7" height="24"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Legacy_AdminRenderSystem</p></span></div></foreignObject></g></g><g id="flowchart-ThemeRenderSystem-33" class="node default"><path d="M-131.6-27h263.2v54h-263.2z" class="basic label-container" transform="translate(2587.781 887)"/><g class="label" transform="translate(2486.181 875)"><rect/><foreignObject width="203.2" height="24"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Legacy_ThemeRenderSystem</p></span></div></foreignObject></g></g><g id="flowchart-XoopsTpl-35" class="node default"><path d="M-90.025-27h180.05v54h-180.05z" class="basic label-container" transform="translate(2859.406 887)"/><g class="label" transform="translate(2799.381 875)"><rect/><foreignObject width="120.05" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XoopsTpl/Smarty</p></span></div></foreignObject></g></g><g id="flowchart-Templates-37" class="node default"><path d="M-70.313-27H70.312v54H-70.313z" class="basic label-container" transform="translate(2859.406 1016)"/><g class="label" transform="translate(2819.094 1004)"><rect/><foreignObject width="80.625" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>(Templates)</p></span></div></foreignObject></g></g><g id="flowchart-DBConnection-39" class="node default"><path d="M-105.444-27h210.887v54h-210.887z" class="basic label-container" transform="translate(1841.484 783)"/><g class="label" transform="translate(1766.04 771)"><rect/><foreignObject width="150.887" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Database Connection</p></span></div></foreignObject></g></g><g id="flowchart-DatabaseFactory-41" class="node default"><path d="M-110.456-27h220.913v54h-220.913z" class="basic label-container" transform="translate(1841.484 887)"/><g class="label" transform="translate(1761.028 875)"><rect/><foreignObject width="160.913" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XoopsDatabaseFactory</p></span></div></foreignObject></g></g><g id="flowchart-MySQLDatabase-43" class="node default"><path d="M-110.106-27h220.213v54h-220.213z" class="basic label-container" transform="translate(1841.484 1016)"/><g class="label" transform="translate(1761.378 1004)"><rect/><foreignObject width="160.213" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XoopsMySQLDatabase</p></span></div></foreignObject></g></g><g id="flowchart-Database-45" class="node default"><path d="M-94.938-27H94.937v54H-94.938z" class="basic label-container" transform="translate(1841.484 1145)"/><g class="label" transform="translate(1776.547 1133)"><rect/><foreignObject width="129.875" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>(MySQL Database)</p></span></div></foreignObject></g></g><g id="flowchart-ModuleHandler-47" class="node default"><path d="M-107.313-27h214.625v54h-214.625z" class="basic label-container" transform="translate(338.566 783)"/><g class="label" transform="translate(261.253 771)"><rect/><foreignObject width="154.625" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XoopsModuleHandler</p></span></div></foreignObject></g></g><g id="flowchart-Module-49" class="node default"><path d="M-65.456-27H65.456v54H-65.456z" class="basic label-container" transform="translate(338.566 887)"/><g class="label" transform="translate(303.11 875)"><rect/><foreignObject width="70.912" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>(Modules)</p></span></div></foreignObject></g></g><g id="flowchart-UserModule-51" class="node default"><path d="M-75.281-27H75.282v54H-75.281z" class="basic label-container" transform="translate(118.281 1016)"/><g class="label" transform="translate(73 1004)"><rect/><foreignObject width="90.563" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>User Module</p></span></div></foreignObject></g></g><g id="flowchart-LegacyModule-53" class="node default"><path d="M-83.719-27H83.719v54H-83.719z" class="basic label-container" transform="translate(327.281 1016)"/><g class="label" transform="translate(273.563 1004)"><rect/><foreignObject width="107.438" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy Module</p></span></div></foreignObject></g></g><g id="flowchart-CustomModules-55" class="node default"><path d="M-89.981-27H89.982v54H-89.981z" class="basic label-container" transform="translate(550.981 1016)"/><g class="label" transform="translate(491 1004)"><rect/><foreignObject width="119.963" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Custom Modules</p></span></div></foreignObject></g></g></g></g></svg>
</div>

<span class="iconify" data-icon="mdi:github"></span> Sources: 
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/include/cubecore_init.php" target="_blank">cubecore_init.php</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php" target="_blank">Legacy_Controller.class.php</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php" target="_blank">Legacy_RenderSystem.class.php</a></code>

## Core System Initialization


XOOPSCube Legacy initialization begins with loading the `mainfile.php` as the entry point, which then includes `cubecore_init.php`. This initializes the `XCube_Root` singleton, loads site configuration, and sets up the controller.

**The initialization sequence follows these steps:**

1. `mainfile.php` includes `cubecore_init.php`
2. `cubecore_init.php` gets the `XCube_Root` singleton instance
3. Site configuration is loaded from INI files
4. The controller is set up based on configuration
5. The `Legacy_Controller` (extending XCube_Controller) prepares the environment
6. Common initialization tasks are executed through `executeCommon()`

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/include/cubecore_init.php#L31-L54" target="_blank">cubecore_init.php#L31-L54</a></code> <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L186-L235" target="_blank">Legacy_Controller.class.php#L186-L235</a></code>


## Controller Strategies

XCL uses the Strategy pattern to handle different types of requests through the controller:

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-b1sdgj6y8" width="640px" aria-roledescription="class" class="classDiagram" style="max-width:697px" viewBox="0 0 697.394 928"><defs><path id="reuse-0" d="m18 7-9 6-8-6 8-6Z"/></defs><style>@keyframes edge-animation-frame{0%{stroke-dashoffset:0}}@keyframes dash{to{stroke-dashoffset:0}}#mermaid-b1sdgj6y8{fill:#fff}#mermaid-b1sdgj6y8 .edge-thickness-normal{stroke-width:1px}#mermaid-b1sdgj6y8 .edge-pattern-solid{stroke-dasharray:0}#mermaid-b1sdgj6y8 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-b1sdgj6y8 .marker{fill:#999;stroke:#999}#mermaid-b1sdgj6y8,#mermaid-b1sdgj6y8 svg{font-family:sans-serif;font-size:14px!important}#mermaid-b1sdgj6y8 p{margin:0}#mermaid-b1sdgj6y8 .edgeLabel,#mermaid-b1sdgj6y8 .nodeLabel{color:#fff}#mermaid-b1sdgj6y8 .edgeLabel .label span,#mermaid-b1sdgj6y8 .labelBkg{background:red}#mermaid-b1sdgj6y8 .node circle,#mermaid-b1sdgj6y8 .node path{fill:#171d30;stroke:#5c6bc0;stroke-width:1px}#mermaid-b1sdgj6y8 .divider{stroke:#5c6bc0;stroke-width:1}#mermaid-b1sdgj6y8 .relation{stroke:#999;stroke-width:1;fill:none}#mermaid-b1sdgj6y8 .composition,#mermaid-b1sdgj6y8 .dependency{fill:#999!important;stroke:#999!important;stroke-width:1}#mermaid-b1sdgj6y8 .aggregation,#mermaid-b1sdgj6y8 .extension,#mermaid-b1sdgj6y8 .lollipop{fill:transparent!important;stroke:#999!important;stroke-width:1}#mermaid-b1sdgj6y8 .lollipop{fill:#fff!important}#mermaid-b1sdgj6y8 :root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif}</style><defs><marker id="mermaid-b1sdgj6y8_class-aggregationStart" class="marker aggregation class" markerHeight="240" markerWidth="190" orient="auto" refX="18" refY="7"><use xlink:href="#reuse-0"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-aggregationEnd" class="marker aggregation class" markerHeight="28" markerWidth="20" orient="auto" refX="1" refY="7"><use xlink:href="#reuse-0"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-extensionStart" class="marker extension class" markerHeight="240" markerWidth="190" orient="auto" refX="18" refY="7"><path d="m1 7 17 6V1Z"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-extensionEnd" class="marker extension class" markerHeight="28" markerWidth="20" orient="auto" refX="1" refY="7"><path d="M1 1v12l17-6Z"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-compositionStart" class="marker composition class" markerHeight="240" markerWidth="190" orient="auto" refX="18" refY="7"><use xlink:href="#reuse-0"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-compositionEnd" class="marker composition class" markerHeight="28" markerWidth="20" orient="auto" refX="1" refY="7"><use xlink:href="#reuse-0"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-dependencyStart" class="marker dependency class" markerHeight="240" markerWidth="190" orient="auto" refX="6" refY="7"><path d="m5 7 4 6-8-6 8-6Z"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-dependencyEnd" class="marker dependency class" markerHeight="28" markerWidth="20" orient="auto" refX="13" refY="7"><path d="m18 7-9 6 5-6-5-6Z"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-lollipopStart" class="marker lollipop class" markerHeight="240" markerWidth="190" orient="auto" refX="13" refY="7"><circle cx="7" cy="7" r="6" fill="transparent" stroke="#000"/></marker></defs><defs><marker id="mermaid-b1sdgj6y8_class-lollipopEnd" class="marker lollipop class" markerHeight="240" markerWidth="190" orient="auto" refX="1" refY="7"><circle cx="7" cy="7" r="6" fill="transparent" stroke="#000"/></marker></defs><g class="root"><g class="edgePaths"><path id="id_XCube_Controller_Legacy_Controller_1" marker-start="url(#mermaid-b1sdgj6y8_class-extensionStart)" d="M348.217 176v32" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_Legacy_Controller_Legacy_ControllerStrategy_2" marker-end="url(#mermaid-b1sdgj6y8_class-dependencyEnd)" d="M348.217 448v44" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_Legacy_ControllerStrategy_Legacy_PublicControllerStrategy_3" marker-start="url(#mermaid-b1sdgj6y8_class-extensionStart)" d="m187.501 705.991-3.689 2.501c-3.688 2.502-11.066 7.505-14.755 14.173-3.688 6.668-3.688 15.002-3.688 19.168V746" class="edge-thickness-normal edge-pattern-dashed relation"/><path id="id_Legacy_ControllerStrategy_Legacy_AdminControllerStrategy_4" marker-start="url(#mermaid-b1sdgj6y8_class-extensionStart)" d="m508.933 705.991 3.689 2.501c3.689 2.502 11.066 7.505 14.755 14.173s3.689 15.002 3.689 19.168V746" class="edge-thickness-normal edge-pattern-dashed relation"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g></g><g class="nodes"><g id="classId-XCube_Controller-7" class="node default"><g class="basic label-container"><path fill="#171d30" stroke-width="0" d="M-114.844-75h229.688V75h-229.688" transform="translate(348.217 83)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-114.844-75h229.688m-229.688 0h229.688m0 0V75m0-150V75m0 0h-229.688m229.688 0h-229.688m0 0V-75m0 150V-75" transform="translate(348.217 83)"/></g><g class="label-group text"><foreignObject width="131" height="24" class="label" style="font-weight:bolder" transform="translate(282.717 20)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:179px;text-align:center"><span class="nodeLabel markdown-node-label"><p>XCube_Controller</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="75.425" height="24" class="label" transform="translate(245.373 98)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:131px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+prepare()</p></span></div></foreignObject><foreignObject width="140.188" height="24" class="label" transform="translate(245.373 122)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:199px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+executeCommon()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-114.844-27h229.688m-229.688 0h229.688M-114.844-3h229.688m-229.688 0h229.688" class="divider" transform="translate(348.217 83)"/></g><g id="classId-Legacy_Controller-8" class="node default"><g class="basic label-container"><path fill="#171d30" stroke-width="0" d="M-130.04-120h260.08v240h-260.08" transform="translate(348.217 328)"/><path fill="none" stroke="#5c6bc0" stroke-width="1.3" d="M-130.04-120h260.08m-260.08 0h260.08m0 0v240m0-240v240m0 0h-260.08m260.08 0h-260.08m0 0v-240m0 240v-240" transform="translate(348.217 328)"/></g><g class="label-group text"><foreignObject width="134.163" height="24" class="label" style="font-weight:bolder" transform="translate(281.136 220)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:184px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_Controller</p></span></div></foreignObject></g><g class="members-group text"><foreignObject width="89.438" height="24" class="label" transform="translate(230.177 268)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:152px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+_mStrategy</p></span></div></foreignObject><foreignObject width="148.613" height="24" class="label" transform="translate(230.177 292)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:209px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+_mAdminModeFlag</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="75.425" height="24" class="label" transform="translate(230.177 340)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:131px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+prepare()</p></span></div></foreignObject><foreignObject width="140.188" height="24" class="label" transform="translate(230.177 364)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:199px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+executeCommon()</p></span></div></foreignObject><foreignObject width="169" height="24" class="label" transform="translate(230.177 388)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:229px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupModuleContext()</p></span></div></foreignObject><foreignObject width="135.387" height="24" class="label" transform="translate(230.177 412)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:196px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+_processModule()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-130.04-72h260.08m-260.08 0h260.08M-130.04 0h260.08m-260.08 0h260.08" class="divider" transform="translate(348.217 328)"/></g><g id="classId-Legacy_ControllerStrategy-9" class="node default"><g class="basic label-container"><path fill="#171d30" stroke-width="0" d="M-145.819-99H145.82V99H-145.82" transform="translate(348.217 597)"/><path fill="none" stroke="#5c6bc0" stroke-width="1.3" d="M-145.819-99H145.82m-291.638 0H145.82m0 0V99m0-198V99m0 0H-145.82m291.638 0H-145.82m0 0V-99m0 198V-99" transform="translate(348.217 597)"/></g><g class="annotation-group text"><foreignObject width="77.375" height="24" class="label" transform="translate(309.53 510)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:132px;text-align:center"><span class="nodeLabel markdown-node-label"><p>«interface»</p></span></div></foreignObject></g><g class="label-group text"><foreignObject width="197.275" height="24" class="label" style="font-weight:bolder" transform="translate(249.58 534)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:247px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_ControllerStrategy</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="141.238" height="24" class="label" transform="translate(214.398 612)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:205px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+_setupFilterChain()</p></span></div></foreignObject><foreignObject width="97.412" height="24" class="label" transform="translate(214.398 636)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:158px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupBlock()</p></span></div></foreignObject><foreignObject width="169" height="24" class="label" transform="translate(214.398 660)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:229px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupModuleContext()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-145.819-27H145.82m-291.638 0H145.82M-145.819-3H145.82M-145.82-3H145.82" class="divider" transform="translate(348.217 597)"/></g><g id="classId-Legacy_PublicControllerStrategy-10" class="node default"><g class="basic label-container"><path fill="#171d30" stroke-width="0" d="M-157.369-87H157.37V87H-157.37" transform="translate(165.369 833)"/><path fill="none" stroke="#5c6bc0" stroke-width="1.3" d="M-157.369-87H157.37m-314.738 0H157.37m0 0V87m0-174V87m0 0H-157.37m314.738 0H-157.37m0 0V-87m0 174V-87" transform="translate(165.369 833)"/></g><g class="label-group text"><foreignObject width="243.475" height="24" class="label" style="font-weight:bolder" transform="translate(43.631 758)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:292px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_PublicControllerStrategy</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="141.238" height="24" class="label" transform="translate(20 836)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:205px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+_setupFilterChain()</p></span></div></foreignObject><foreignObject width="97.412" height="24" class="label" transform="translate(20 860)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:158px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupBlock()</p></span></div></foreignObject><foreignObject width="169" height="24" class="label" transform="translate(20 884)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:229px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupModuleContext()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-157.369-39H157.37m-314.738 0H157.37M-157.369-15H157.37m-314.738 0H157.37" class="divider" transform="translate(165.369 833)"/></g><g id="classId-Legacy_AdminControllerStrategy-11" class="node default"><g class="basic label-container"><path fill="#171d30 stroke-width="0" d="M-158.328-87h316.656V87h-316.656" transform="translate(531.066 833)"/><path fill="none" stroke="#5c6bc0" stroke-width="1.3" d="M-158.328-87h316.656m-316.656 0h316.656m0 0V87m0-174V87m0 0h-316.656m316.656 0h-316.656m0 0V-87m0 174V-87" transform="translate(531.066 833)"/></g><g class="label-group text"><foreignObject width="247.313" height="24" class="label" style="font-weight:bolder" transform="translate(407.41 758)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:294px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_AdminControllerStrategy</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="141.238" height="24" class="label" transform="translate(384.738 836)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:205px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+_setupFilterChain()</p></span></div></foreignObject><foreignObject width="97.412" height="24" class="label" transform="translate(384.738 860)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:158px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupBlock()</p></span></div></foreignObject><foreignObject width="169" height="24" class="label" transform="translate(384.738 884)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:229px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setupModuleContext()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-158.328-39h316.656m-316.656 0h316.656M-158.328-15h316.656m-316.656 0h316.656" class="divider" transform="translate(531.066 833)"/></g></g></g></svg>
</p>

The controller determines which strategy to use by parsing the request URL:


```php
$urlInfo = $this->_parseUrl();

$adminStateFlag = false;
if (count($urlInfo) >= 3) {
    if ('modules' === strtolower($urlInfo[0])) {
        if ('admin' === strtolower($urlInfo[2])) {
            $adminStateFlag = true;
        } elseif ('legacy' === $urlInfo[1] && 'include' === $urlInfo[2]) {
            $adminStateFlag = true;
        }
    }
} elseif (strpos($urlInfo[0], 'admin.php') === 0) {
    $adminStateFlag = true;
}

if ($adminStateFlag) {
    $this->_mStrategy = new Legacy_AdminControllerStrategy($this);
} else {
    $this->_mStrategy = new Legacy_PublicControllerStrategy($this);
}
```

The Admin strategy handles the control panel interface, while the Public strategy handles front-end requests.


<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L149-L181" target="_blank">Legacy_Controller.class.php#L149-L181</a></code>


## Request Processing Flow

When a request is received, it flows through the following components:

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-cl6a8aaex1m" width="100%" aria-roledescription="sequence" style="max-width:1900.5px" viewBox="-50 -10 1900.5 877"><rect width="150" height="65" x="1650.5" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="1725.5" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1725.5" dy="0">&quot;Modules&quot;</tspan></text><rect width="150" height="65" x="1450.5" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="1525.5" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1525.5" dy="0">&quot;Render System&quot;</tspan></text><rect width="150" height="65" x="1250.5" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="1325.5" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1325.5" dy="0">&quot;Protector&quot;</tspan></text><rect width="165" height="65" x="1022" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="1104.5" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1104.5" dy="0">&quot;Legacy_Controller&quot;</tspan></text><rect width="160" height="65" x="812" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="892" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="892" dy="0">&quot;XCube_Controller&quot;</tspan></text><rect width="150" height="65" x="612" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="687" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="687" dy="0">&quot;XCube_Root&quot;</tspan></text><rect width="162" height="65" x="400" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="481" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="481" dy="0">&quot;cubecore_init.php&quot;</tspan></text><rect width="150" height="65" x="200" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="275" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="275" dy="0">&quot;mainfile.php&quot;</tspan></text><rect width="150" height="65" y="791" fill="#212745" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="75" y="823.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="75" dy="0">&quot;Client Browser&quot;</tspan></text><line id="actor29" x1="1725.5" x2="1725.5" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-29"><rect width="150" height="65" x="1650.5" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="1725.5" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1725.5" dy="0">&quot;Modules&quot;</tspan></text></g><line id="actor28" x1="1525.5" x2="1525.5" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-28"><rect width="150" height="65" x="1450.5" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="1525.5" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1525.5" dy="0">&quot;Render System&quot;</tspan></text></g><line id="actor27" x1="1325.5" x2="1325.5" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-27"><rect width="150" height="65" x="1250.5" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="1325.5" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1325.5" dy="0">&quot;Protector&quot;</tspan></text></g><line id="actor26" x1="1104.5" x2="1104.5" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-26"><rect width="165" height="65" x="1022" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="1104.5" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="1104.5" dy="0">&quot;Legacy_Controller&quot;</tspan></text></g><line id="actor25" x1="892" x2="892" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-25"><rect width="160" height="65" x="812" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="892" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="892" dy="0">&quot;XCube_Controller&quot;</tspan></text></g><line id="actor24" x1="687" x2="687" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-24"><rect width="150" height="65" x="612" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="687" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="687" dy="0">&quot;XCube_Root&quot;</tspan></text></g><line id="actor23" x1="481" x2="481" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-23"><rect width="162" height="65" x="400" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="481" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="481" dy="0">&quot;cubecore_init.php&quot;</tspan></text></g><line id="actor22" x1="275" x2="275" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-22"><rect width="150" height="65" x="200" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="275" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="275" dy="0">&quot;mainfile.php&quot;</tspan></text></g><line id="actor21" x1="75" x2="75" y1="65" y2="791" stroke="#999" stroke-width=".5" class="actor-line 200"/><g id="root-21"><rect width="150" height="65" fill="#212745" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="75" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="75" dy="0">&quot;Client Browser&quot;</tspan></text></g><style><![CDATA[@keyframes edge-animation-frame{0%{stroke-dashoffset:0}}@keyframes dash{to{stroke-dashoffset:0}}#mermaid-cl6a8aaex1m{fill:#111}#mermaid-cl6a8aaex1m,#mermaid-cl6a8aaex1m svg{font-family:ui-sans-serif,-apple-system,system-ui,Segoe UI,Helvetica;font-size:16px}#mermaid-cl6a8aaex1m .actor{stroke:#face74;fill:#212745}#mermaid-cl6a8aaex1m text.actor>tspan{fill:#fff;stroke:none}#mermaid-cl6a8aaex1m .actor-line{stroke:#ccc}#mermaid-cl6a8aaex1m .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#999}#mermaid-cl6a8aaex1m #arrowhead path,#mermaid-cl6a8aaex1m #crosshead path{fill:#999;stroke:#999}#mermaid-cl6a8aaex1m #sequencenumber{fill:#999}#mermaid-cl6a8aaex1m .messageText{fill:#111;stroke:none}#mermaid-cl6a8aaex1m line{stroke:#ccc;fill:#fff;stroke-width:2px}#mermaid-cl6a8aaex1m :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}]]></style><defs><symbol id="computer"><path d="M1 1v6.5h10V1H1zm9 5.5H2V2h8v4.5zm-5.114 3 .233-.5h1.762l.234.5H4.886zM12 11H0l1-3h1.052l-.665 2h9.225l-.648-2H11l1 3zM9.5 6h-7V2.5h7V6z"/></symbol></defs><defs><symbol id="database" fill-rule="evenodd" clip-rule="evenodd"><path d="m6.129 0 .128.003.128.002.126.004.126.005.124.006.123.008.123.008.122.009.12.01.12.012.118.011.116.014.116.014.114.015.113.017.111.017.11.018.108.019.107.02.106.02.104.021.102.023.101.023.099.024.097.025.095.026L9.18.4l.091.027.09.028.088.029.086.029.084.03.081.03.08.032.078.032.075.033.037.017.036.016.036.017.035.017.034.018.034.017.034.018.033.017.032.018.032.018.031.018.03.018.03.019.029.018.029.018.027.02.028.019.026.019.026.019.026.019.025.02.024.019.023.02.023.02.022.02.021.02.021.02.02.02.02.02.018.021.018.02.017.021.016.021.016.021.015.021.015.021.013.021.013.021.012.022.012.021.01.022.01.021.01.022.008.022.007.022.007.022.006.022.005.023.005.022.004.022.003.023.002.022v.022L11 1.75v8.522l-.001.023-.002.023-.003.022-.004.023-.004.022-.006.022-.006.022-.006.022-.008.022-.009.022-.009.022-.01.021-.01.022-.012.021-.012.022-.013.021-.013.021-.015.021-.015.021-.016.021-.016.021-.017.02-.018.021-.019.02-.019.021-.02.02-.02.02-.022.02-.022.02-.023.02-.023.02-.024.02-.025.019-.026.02-.026.019-.026.019-.028.019-.027.019-.029.018-.029.019-.03.018-.03.018-.031.018-.032.018-.032.018-.033.018-.034.017-.034.018-.034.017-.035.017-.036.017-.036.017-.037.016-.075.033-.078.032-.08.032-.081.03-.084.03-.086.03-.088.028-.09.028-.091.027-.094.027-.095.025-.097.025-.099.024-.1.023-.103.023-.104.021-.106.02-.107.02-.108.02-.11.018-.112.017-.112.016-.115.015-.115.014-.116.014-.118.012-.12.011-.12.01-.121.01-.123.008-.124.007-.124.006-.126.005-.127.004-.127.003-.128.002h-.258l-.128-.002-.128-.003-.126-.004-.126-.005-.124-.006-.123-.007-.123-.008-.121-.01-.121-.01-.119-.011-.118-.012-.117-.014-.116-.014-.113-.015-.113-.016-.112-.017-.11-.018-.108-.02-.107-.02-.106-.02-.104-.021-.102-.023-.1-.023-.1-.024-.097-.025-.095-.025-.094-.027-.092-.027-.089-.028-.088-.028-.086-.03-.084-.03-.082-.03-.079-.032-.078-.032-.075-.033-.037-.016-.036-.017-.036-.017-.035-.017-.035-.017-.034-.018-.033-.017-.033-.018-.032-.018-.032-.018-.03-.018-.031-.018-.03-.018-.029-.019-.029-.018-.028-.02-.027-.018-.027-.02-.026-.018-.025-.02-.025-.02-.024-.019-.023-.02-.023-.02-.022-.02-.021-.02-.021-.02-.02-.02-.02-.02-.018-.021-.018-.02-.017-.021-.017-.021-.016-.021-.015-.021-.014-.021-.013-.021-.013-.021-.012-.022-.012-.021-.01-.022-.01-.021-.01-.022-.008-.022-.007-.022-.007-.022-.006-.022-.005-.022-.005-.022-.003-.023-.003-.022-.002-.023L1 10.273 1 10.25V1.728l.002-.023.002-.022.003-.023.003-.022.005-.022.005-.023.006-.022.007-.022.007-.022.009-.021.009-.022.01-.022.01-.021.011-.022.013-.022.013-.021.013-.021.015-.021.015-.021.016-.021.016-.021.017-.02.018-.021.018-.02.02-.021.02-.02.02-.02.022-.02.022-.02.023-.02.023-.02.024-.02.025-.019.025-.02.026-.019.027-.019.027-.019.028-.019.029-.018.029-.019.03-.018.03-.018.031-.018.032-.018.032-.018.033-.018.033-.017.034-.018.035-.017.035-.017.036-.017.036-.016.037-.017.075-.033.078-.032.08-.031.081-.031.084-.03.086-.03.088-.028.09-.028L2.82.4l.094-.026.095-.026.098-.025.098-.024.101-.023.102-.023.104-.021.105-.02.108-.02.108-.02.11-.017.112-.018.113-.015.114-.016.115-.014.117-.013.118-.012.119-.012.12-.01.122-.01.122-.007L5.24.02l.124-.006.126-.005.127-.004.127-.002L5.871 0 6 0h.129zM1.5 10.25v.015l.002.011.002.011.003.01.003.012.003.01.004.012.005.011.006.011.006.012.006.011.008.012.008.012.008.011.01.012.009.012.01.012.011.013.012.012.012.013.026.024.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.025.052.026.056.026.057.026.059.025.061.026.064.025.066.025.067.025.07.024.072.024.073.024.076.023.078.024.08.022.081.023.084.021.085.022.088.02.089.021.092.02.093.019.095.018.097.018.099.017.1.017.103.015.104.015.106.015.108.013.11.013.11.012.114.01.115.01.116.01.118.007.12.008.122.006.123.005.124.004.127.002.128.002L6 11.5h.13l.129-.003.127-.002.125-.004.123-.006.122-.006.12-.007.119-.008.117-.009.115-.01.113-.01.112-.013.11-.013.108-.013.106-.014.105-.016.103-.015.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.025.066-.025.063-.025.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.025.046-.027.044-.026.041-.025.04-.026.037-.026.035-.026.032-.025.03-.026.028-.025.026-.025.011-.012.012-.012.01-.012.01-.012.01-.012.009-.012.008-.012.008-.012.007-.012.006-.011.006-.012.005-.011.005-.011.004-.011.003-.011.003-.011.002-.011.002-.011v-.01l.001-.011V8.187l-.038.027-.04.027-.042.027-.042.026-.044.026-.045.026-.046.026-.048.025-.048.025-.05.024-.051.025-.053.024-.053.023-.054.024-.056.023-.057.022-.057.023-.06.022-.06.021-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.019-.068.018-.069.019-.07.017-.07.018-.072.017-.072.016-.073.016-.074.016-.075.015-.076.015-.076.014-.077.014-.078.013-.08.013L8 9.028l-.08.012-.081.011-.082.011-.082.01-.083.01-.084.01-.084.009-.085.009-.085.008-.087.007-.086.007-.088.007-.087.006-.089.005-.089.005-.09.004-.089.004-.09.003-.091.003-.091.002-.092.001-.092.001h-.185l-.092-.001-.092-.001-.091-.002-.091-.003-.091-.003-.09-.004-.089-.004-.089-.005-.088-.005-.088-.006-.087-.007-.087-.007-.086-.007-.085-.008-.085-.009-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.011L4 9.028l-.08-.013-.078-.013-.078-.013-.077-.014-.077-.014-.075-.015-.075-.015-.074-.016-.073-.016-.073-.016-.071-.017-.071-.018-.07-.017-.068-.019-.068-.018-.067-.02-.066-.018-.065-.02-.064-.02-.063-.021-.062-.021-.061-.021-.06-.022-.059-.021-.058-.023-.056-.022-.056-.023-.055-.024-.053-.023-.052-.024-.051-.025-.05-.024-.049-.025-.047-.025-.047-.026-.045-.026-.043-.026-.043-.026-.041-.027-.04-.027-.039-.027v2.063zm0-2.827v.016l.002.01.002.011.003.011.003.011.003.011.004.011.005.011.006.012.006.011.006.012.008.012.008.011.008.012.01.012.009.012.01.012.011.012.012.012.012.012.026.025.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.026.052.026.056.025.057.026.059.026.061.025.064.025.066.025.067.025.07.024.072.024.073.024.076.024.078.023.08.022.081.023.084.022.085.021.088.021.089.02.092.02.093.019.095.018.097.018.099.017.1.017.103.016.104.015.106.014.108.013.11.013.11.012.114.011.115.01.116.009.118.008.12.007.122.006.123.005.124.004.127.003.128.001.129.001h.13l.129-.002.127-.003.125-.004.123-.005.122-.006.12-.008.119-.008.117-.009.115-.01.113-.01.112-.013.11-.012.108-.014.106-.014.105-.015.103-.016.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.024.066-.025.063-.026.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.025.035-.026.032-.026.03-.025.028-.025.026-.025.011-.012.012-.012.01-.013.01-.012.01-.012.009-.012.008-.012.008-.011.007-.012.006-.012.006-.01.005-.012.005-.012.004-.01.003-.012.003-.01.002-.011.002-.011v-.01l.001-.011v-2.07l-.038.027-.04.027-.042.027-.042.026-.044.027-.045.025-.046.026-.048.025-.048.025-.05.025-.051.024-.053.024-.053.024-.054.023-.056.023-.057.023-.057.022-.06.022-.06.022-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.018-.068.019-.069.018-.07.018-.07.017-.072.017-.072.016-.073.017-.074.015-.075.015-.076.015-.076.014-.077.014-.078.014-.08.013L8 6.194l-.08.012-.081.012-.082.011-.082.01-.083.01-.084.01-.084.009-.085.008-.085.008-.087.008-.086.007-.088.006-.087.006-.089.006-.089.004-.09.005-.089.003-.09.004-.091.002-.091.002-.092.002-.092.001h-.185l-.092-.001-.092-.002-.091-.002-.091-.002-.091-.004-.09-.003-.089-.005-.089-.004-.088-.006-.088-.006L4.92 6.3l-.087-.007-.086-.008-.085-.008-.085-.008-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.012L4 6.194l-.08-.012-.078-.013-.078-.014-.077-.014-.077-.014-.075-.015-.075-.015-.074-.015-.073-.017-.073-.016-.071-.017-.071-.017-.07-.018-.068-.018-.068-.019-.067-.019-.066-.019-.065-.02-.064-.02-.063-.02-.062-.021-.061-.022-.06-.021-.059-.022-.058-.022-.056-.023-.056-.023-.055-.023-.053-.024-.052-.024-.051-.024-.05-.025-.049-.025-.047-.025-.047-.026-.045-.025-.043-.027-.043-.026-.041-.027-.04-.027-.039-.027v2.07zm0-2.833v.015l.002.011.002.011.003.011.003.01.003.012.004.011.005.011.006.011.006.012.006.011.008.012.008.012.008.012.01.011.009.012.01.013.011.012.012.012.012.012.026.025.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.026.052.025.056.026.057.026.059.025.061.026.064.025.066.025.067.025.07.024.072.024.073.024.076.024.078.023.08.022.081.023.084.021.085.022.088.021.089.02.092.02.093.019.095.018.097.018.099.017.1.017.103.016.104.015.106.014.108.013.11.013.11.012.114.01.115.01.116.01.118.008.12.007.122.006.123.005.124.004.127.003.128.001L6 5.84h.13l.129-.002.127-.003.125-.004.123-.005.122-.007.12-.007.119-.008.117-.009.115-.01.113-.01.112-.013.11-.012.108-.014.106-.014.105-.015.103-.016.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.024.066-.026.063-.025.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.026.035-.025.032-.025.03-.026.028-.025.026-.025.011-.012.012-.013.01-.012.01-.012.01-.011.009-.012.008-.012.008-.012.007-.012.006-.011.006-.012.005-.011.005-.011.004-.011.003-.011.003-.011.002-.011.002-.011v-.01l.001-.011V2.514l-.038.027-.04.027-.042.026-.042.027-.044.026-.045.026-.046.025-.048.026-.048.025-.05.024-.051.024-.053.024-.053.024-.054.023-.056.023-.057.023-.057.022-.06.022-.06.022-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.019-.068.018-.069.018-.07.018-.07.017-.072.017-.072.017-.073.016-.074.016-.075.015-.076.015-.076.014-.077.014-.078.013-.08.013L8 3.354l-.08.012-.081.012-.082.011-.082.01-.083.01-.084.01-.084.009-.085.009-.085.008-.087.007-.086.007-.088.007-.087.006-.089.005-.089.005-.09.004-.089.004-.09.002-.091.004-.091.002-.092.001h-.092L6 3.5h-.092l-.092-.001-.092-.002-.091-.001-.091-.003-.091-.003-.09-.004-.089-.004-.089-.006-.088-.004-.088-.006-.087-.007-.087-.007-.086-.007-.085-.008-.085-.009-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.012L4 3.354l-.08-.012-.078-.013-.078-.013-.077-.014-.077-.014-.075-.015-.075-.015-.074-.016-.073-.016-.073-.017-.071-.017-.071-.017-.07-.018-.068-.018-.068-.018-.067-.02-.066-.019-.065-.02-.064-.02-.063-.02L2.505 3l-.061-.021-.06-.022-.059-.022-.058-.022-.056-.023-.056-.023-.055-.023-.053-.024-.052-.024-.051-.024-.05-.025-.049-.024-.047-.026-.047-.025-.045-.026-.043-.026-.043-.027-.041-.026-.04-.027-.039-.027V4.59zM5.87.5l-.129.002-.126.003-.125.004-.124.005-.122.006-.12.007-.119.008-.116.01-.116.01-.113.011-.112.011-.11.013-.108.014-.106.014-.105.015-.102.016-.102.017-.099.017-.097.018-.095.019-.094.019-.091.02-.09.02L3.262.8l-.086.022-.084.021-.082.023-.08.023-.077.023-.076.024-.074.024-.072.024-.069.024-.068.025-.066.025-.063.026-.061.025-.059.026-.057.026-.055.026-.053.026-.05.026-.049.026-.046.026-.044.026-.041.026-.04.026-.037.025-.035.026-.032.026-.03.025-.028.025-.026.025-.011.012-.012.012-.01.012-.01.013-.01.012-.009.012-.008.011-.008.012-.007.012-.006.011-.006.012-.005.011-.005.011-.004.011-.003.012-.003.01-.002.011-.002.011v.01L1.5 1.75v.01l.001.011.002.01.002.011.003.011.003.011.004.011.005.011.005.012.006.011.006.012.007.011.008.012.008.012.01.012.009.012.01.012.01.012.012.012.011.013.026.025.028.025.03.025.032.025.035.026.037.026.04.026.041.026.044.026.046.026.048.026.051.026.053.026.055.026.057.026.059.025.061.026.063.025.066.025.068.025.07.025.071.024.074.024.076.024.077.023.08.023.082.022.084.022.086.021.087.021.09.021.091.02.094.019.095.019.097.018.1.017.1.016.103.016.105.016.106.014.108.013.11.013.112.012.113.011.116.01.116.01.119.007.12.007.122.006.124.006.125.004.127.002L5.87 3 6 3h.13l.129-.003.126-.002.125-.004.124-.006.122-.006.12-.007.119-.008.116-.009.116-.01.113-.011.112-.012.11-.013.108-.013.106-.014.105-.016.102-.016.102-.016.098-.017.098-.018.095-.019.093-.019.092-.02.09-.02.087-.022.086-.021.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.071-.024.07-.025.068-.025.066-.025.063-.025.061-.026.059-.025.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.026.035-.026.032-.025.03-.025.028-.025.026-.025.011-.013.012-.012.01-.012.01-.012.01-.012.009-.012.008-.012.007-.012.008-.011.006-.012.006-.011.005-.012.005-.01.004-.012.003-.011.003-.01.002-.012.002-.01v-.01l.001-.011v-.01l-.001-.011-.002-.01-.002-.012-.003-.01-.003-.011-.004-.011-.005-.011-.005-.012-.006-.011-.006-.012-.007-.011-.008-.013-.009-.011-.008-.012-.01-.012-.01-.013-.01-.012-.012-.012-.011-.012-.026-.025-.028-.025-.03-.025-.032-.025-.035-.026-.037-.026-.04-.026-.042-.026-.043-.026-.046-.026-.048-.026-.051-.026-.053-.026-.055-.026-.057-.026-.059-.026-.061-.025-.063-.026-.066-.025-.068-.025-.07-.024L9.298.96 9.223.936 9.147.912 9.07.889 8.99.866 8.907.843 8.824.822 8.738.8 8.651.78 8.56.758 8.47.739 8.376.72 8.28.701 8.184.683l-.1-.017-.1-.017L7.88.633 7.776.618 7.67.604 7.562.59l-.11-.013L7.34.566 7.227.555l-.116-.01-.116-.01-.119-.008-.12-.007-.122-.006L6.51.51 6.385.505 6.258.502 6.13.5h-.26z"/></symbol></defs><defs><symbol id="clock"><path d="M6 1c2.757 0 5 2.243 5 5s-2.243 5-5 5-5-2.243-5-5 2.243-5 5-5zm0-1a6 6 0 1 0 0 12A6 6 0 0 0 6 0zm2.924 6.23c.101.018.101.166 0 .185-.953.181-3.022.556-3.273.556a.65.65 0 0 1-.65-.65c0-.256.384-2.724.562-3.723.017-.096.156-.09.172.007l.492 3.119 2.697.505z"/></symbol></defs><defs><marker id="arrowhead" markerHeight="12" markerUnits="userSpaceOnUse" markerWidth="12" orient="auto-start-reverse" refX="7.9" refY="5"><path d="m-1 0 11 5-10 5z"/></marker></defs><defs><marker id="crosshead" markerHeight="8" markerWidth="15" orient="auto" refX="4" refY="4.5"/></defs><defs><marker id="filled-head" markerHeight="28" markerWidth="20" orient="auto" refX="15.5" refY="7"><path d="m18 7-9 6 5-6-5-6Z"/></marker></defs><defs><marker id="sequencenumber" markerHeight="40" markerWidth="60" orient="auto" refX="15" refY="15"><circle cx="15" cy="15" r="6"/></marker></defs><text x="174" y="80" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">HTTP Request</text><line x1="76" x2="271" y1="117" y2="117" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="799" y="132" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Security Pre-Check</text><line x1="276" x2="1321.5" y1="169" y2="169" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="377" y="184" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Initialize Core</text><line x1="276" x2="477" y1="221" y2="221" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="583" y="236" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">getSingleton()</text><line x1="482" x2="683" y1="273" y2="273" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="583" y="288" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">loadSiteConfig()</text><line x1="482" x2="683" y1="325" y2="325" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="583" y="340" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">setupController()</text><line x1="482" x2="683" y1="377" y2="377" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="788" y="392" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">prepare()</text><line x1="688" x2="888" y1="429" y2="429" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="997" y="444" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">executeCommon()</text><line x1="893" x2="1100.5" y1="481" y2="481" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="1106" y="496" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">setupModuleContext()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M1105.5 533c60-10 60 30 0 20" class="messageLine0" style="fill:none"/><text x="1414" y="578" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">execute()</text><line x1="1105.5" x2="1721.5" y1="615" y2="615" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="1627" y="630" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">render()</text><line x1="1724.5" x2="1529.5" y1="667" y2="667" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="1214" y="682" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Security Post-Check</text><line x1="1105.5" x2="1321.5" y1="719" y2="719" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/><text x="802" y="734" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">HTTP Response</text><line x1="1524.5" x2="79" y1="771" y2="771" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"/></svg>
</p>


The `executeCommon()` method in `Legacy_Controller` handles the main request flow:


```php
public function executeCommon()
{
    $this->_setupFilterChain();
    $this->_processFilter();

    if (!defined('XC_FORCE_DEBUG_PHP')) {
        error_reporting(0);
    }

    $this->_setupErrorHandler();
    $this->_setupEnvironment();
    $this->_setupLogger();
    $this->_setupDB();
    $this->_setupLanguage();
    $this->_setupTextFilter();
    $this->_setupConfig();
    $this->_setupScript();
    $this->_setupDebugger();
    $this->_loadInterfaceFiles();
    $this->_processPreBlockFilter();
    $this->_setupSession();
    $this->_setupUser();
    $this->setupModuleContext();
    $this->_processModule();
    $this->_processPostFilter();
}
```

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L186-L235" target="_blank">cubecore_init.php#L51-L54</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L490-L552" target="_blank">common.php</a></code>


## Modular Architecture

Modules are the primary way to extend XCL functionality. Each module has a standardized structure, and each module defines its features in a manifest file `xoops_version.php`:

```php
$modversion['dirname']          = 'legacy';
$modversion['name']             = _MI_LEGACY_NAME;
$modversion['version']          = '2.50';
$modversion['detailed_version'] = '2.50.0';
$modversion['description']      = _MI_LEGACY_NAME_DESC;
$modversion['author']           = 'The XOOPSCube Project Team';
$modversion['credits']          = 'The XOOPSCube Project Team';
$modversion['help']             = 'help.html';
$modversion['license']          = 'GPL see LICENSE';
```

The module context is established in the `setupModuleContext()` method based on the URL structure:


```php
public function setupModuleContext($dirname = null)
{
    if (null == $dirname) {
        $urlInfo = $this->_parseUrl();
        
        if (count($urlInfo) >= 2) {
            if ('modules' === strtolower($urlInfo[0])) {
                $dirname = $urlInfo[1];
            }
        }
        if ('admin.php' === substr($urlInfo[0], 0, 9)) {
            $dirname = 'legacy';
        }
    }
    
    if (null == $dirname) {
        return;
    }
    
    $this->_mStrategy->setupModuleContext($this->mRoot->mContext, $dirname);
}
```

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/xoops_version.php#L11-L22
https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/user/xoops_version.php#L6-L17" target="_blank">xoops_version.php#L6-L17</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/xoops_version.php#L7-L17" target="_blank">xoops_version.php#L7-L17</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L490-L521" target="_blank">Legacy_Controller.class.php#L490-L521</a></code>

?>**Note** For information about XCube Core component, see <a href="../development/xcube-module.md"> XCube Module</a>

## Render System



### Header Script and Meta Information

XCL provides a centralized way to manage JavaScript, CSS, and meta information through the Legacy_HeaderScript class:

Meta information and scripts are added through this system and then rendered in the theme:

```php
// Add a meta tag
$headerScript->addMeta('keywords', 'XOOPSCube, CMS, Content Management');

// Add a JavaScript library
$headerScript->addLibrary('/common/js/custom.js');

// Add inline JavaScript
$headerScript->addScript('alert("Hello World!");');
```

<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/class/Legacy_HeaderScript.class.php#L18-L307
">Legacy_HeaderScript.class.php#L18-L307</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/admin/actions/AdminRenderAction.class.php#L35-L73" target="_blank">AdminRenderAction.class.php#L35-L73</a></code>


?>**Note** For information about the Render System, see <a href="../development/xcl-render.md"> XCL Render</a>

### Delegate System

Modules can attach callbacks to these delegates to extend or modify functionality without changing core code. Delegates are registered in the controller constructor:

```php
public function __construct()
{
    parent::__construct();

    $this->mSetupUser->register('Legacy_Controller.SetupUser');

    $this->mCheckLogin = new XCube_Delegate();
    $this->mCheckLogin->register('Site.CheckLogin');

    $this->mLogout = new XCube_Delegate();
    $this->mLogout->register('Site.Logout');

    $this->mCreateLanguageManager = new XCube_Delegate();
    $this->mCreateLanguageManager->register('Legacy_Controller.CreateLanguageManager');

    // Additional delegates...
}
```

?>**Note** For information about this Core component, see <a href="/#/en/development/xcube-delegate.md"> XCube Delegate</a>


<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="
https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L116-L146" target="_blank">Legacy_Controller.class.php#L116-L146</a></code>



## Database Abstraction Layer

XCL uses a database abstraction layer to support different database systems

The database connection is established in the _setupDB() method:

```php
public function _setupDB()
{
    if (!defined('XOOPS_XMLRPC')) {
        define('XOOPS_DB_CHKREF', 1);
    } else {
        define('XOOPS_DB_CHKREF', 0);
    }

    require_once XOOPS_ROOT_PATH.'/class/database/databasefactory.php';

    if (true == $this->mRoot->getSiteConfig('Legacy', 'AllowDBProxy')) {
        if ('POST' !== xoops_getenv('REQUEST_METHOD') || !xoops_refcheck(XOOPS_DB_CHKREF)) {
            define('XOOPS_DB_PROXY', 1);
        }
    } elseif ('POST' !== xoops_getenv('REQUEST_METHOD')) {
        define('XOOPS_DB_PROXY', 1);
    }

    $this->mDB =& XoopsDatabaseFactory::getDatabaseConnection();
    $GLOBALS['xoopsDB']=&$this->mDB;
}
```

<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L624-L646" target="_blank">/kernel/Legacy_Controller.class.php#L624-L646</a></code>



## Caching Mechanism

XCL includes a sophisticated caching system to improve performance:

The Standard Cache module (stdCache) provides management of the cache. This is particularly visible in the block rendering process:

```php
if ($this->isEnableCacheFeature() && $blockProcedure->isEnableCache()) {
    $cacheInfo =& $blockProcedure->createCacheInfo();
    $this->mSetBlockCachePolicy->call(new XCube_Ref($cacheInfo));
    $filepath = $cacheInfo->getCacheFilePath();
    
    if ($cacheInfo->isEnableCache() && $this->existActiveCacheFile($filepath, $blockProcedure->getCacheTime())) {
        $content = $this->loadCache($filepath);
        // Use cached content
        $usedCacheFlag = true;
    }
}
```

The cache policy can be customized by modules through delegates.

<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L402-L430
" target="_blank">Legacy_Controller.class.php#L402-L430</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/stdCache/xoops_version.php#L10-L38" target="_blank">/stdCache/xoops_version.php#L10-L38"</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/stdCache/preload/Initialize.class.php" target="_blank">Initialize.class.php</a></code>


## Version Information

XCL defines version constants throughout the system. The main version is defined in Legacy_Controller.class.php:

<div class="table-wrapper">
<table><thead><tr><th>Component</th><th>Version</th></tr></thead><tbody><tr><td>XCL Core</td><td>2.5.0 (LEGACY_MODULE_VERSION)</td></tr><tr><td>Legacy Module</td><td>2.50.0</td></tr><tr><td>LegacyRender Module</td><td>2.50.0</td></tr><tr><td>StdCache Module</td><td>2.50.0</td></tr><tr><td>User Module</td><td>2.50.0</td></tr></tbody></table>
</div>

<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L20-L20" target="_blank">Legacy_Controller.class.php#L20-L20</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/include/version.php#L10-L10" target="_blank">/html/include/version.php#L10-L10</a></code>
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/xoops_version.php#L13-L14" target="_blank">/modules/legacy/xoops_version.php#L13-L14</a></code>


## Licensing

XOOPSCube Legacy is divided into two main licensing components. This dual-licensing approach reflects the project's history and structure, with the minimal core being more permissively licensed.

- **XCube Core**: The minimalist foundation, released under the BSD license
- **Legacy Package**: A set of modules for backward compatibility, released under the GPL license

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/BSD_license.txt" target="_blank">BSD_license.txt</a></code> <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/gpl-2.0_license.md" target="_blank">gpl-2.0_license.md</a></code>



## History and Development

XOOPSCube Legacy has undergone significant development since its inception. The current version 2.5.0 represents years of improvements, with major changes in each release addressing security, performance, and functionality.

<div class="table-wrapper">
<table><thead><tr><th>Version</th><th>Notable Changes</th></tr></thead><tbody><tr><td>2.5.0</td><td>PHP 8.2 support, Admin dashboard improvements, Various module updates</td></tr><tr><td>2.3.3</td><td>PHP 8.0 support, Module updates, Template improvements</td></tr><tr><td>2.3.1</td><td>Admin interface updates, Core module changes</td></tr><tr><td>2.2.3</td><td>Various bug fixes, Module updates</td></tr><tr><td>2.2.2</td><td>Delegate call chain improvements</td></tr><tr><td>2.2.1</td><td>Backward compatibility fixes</td></tr><tr><td>2.2.0</td><td>New delegate points, HTML Purifier integration</td></tr></tbody></table>
</div>

<span class="iconify" data-icon="mdi:github"></span> Source: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/CHANGELOG.md" target="_blank">CHANGELOG.md</a></code>


---


### Key Takeaways

XOOPSCube Legacy provides a robust and flexible foundation for web applications with its modular architecture, delegate system, and rendering capabilities. Its separation of core components from legacy compatibility layers allows for both innovation and backward compatibility. The system's emphasis on extensibility through modules and themes makes it suitable for a wide range of web applications.

