
### Purpose and Scope

`Legacy_RenderSystem`

This document details the `Legacy_RenderSystem` component in XOOPSCube Legacy, which serves as the rendering engine that processes and displays content through templates. It provides compatibility with XOOPS v2 themes and templates while implementing modern rendering practices.

For information about the broader rendering architecture, see Rendering System. For theme-specific details, see Theme Architecture.


## Render System and Template Engine

The `Legacy_RenderSystem` is responsible for generating HTML output by processing templates through the Smarty template engine. It manages various render targets (main content, blocks, themes) and ensures proper variable assignment and template processing.


<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-i94l5n9v9d7" aria-roledescription="class" class="xcl-diagram" style="max-width:772.4827880859375px" viewBox="0 0 772.483 1138"><defs><marker id="mermaid-i94l5n9v9d7_class-aggregationStart" class="marker aggregation class" markerHeight="240" markerWidth="190" orient="auto" refX="18" refY="7"><path d="m18 7-9 6-8-6 8-6Z"/></marker></defs><defs><marker id="mermaid-i94l5n9v9d7_class-extensionStart" class="marker extension class" markerHeight="240" markerWidth="190" orient="auto" refX="18" refY="7"><path d="m1 7 17 6V1Z"/></marker></defs><defs><marker id="mermaid-i94l5n9v9d7_class-compositionStart" class="marker composition class" markerHeight="240" markerWidth="190" orient="auto" refX="18" refY="7"><path d="m18 7-9 6-8-6 8-6Z"/></marker></defs><defs><marker id="mermaid-i94l5n9v9d7_class-dependencyEnd" class="marker dependency class" markerHeight="28" markerWidth="20" orient="auto" refX="13" refY="7"><path d="m18 7-9 6 5-6-5-6Z"/></marker></defs><g class="root"><g class="edgePaths"><path id="id_XCube_RenderSystem_Legacy_RenderSystem_1" marker-start="url(#mermaid-i94l5n9v9d7_class-extensionStart)" d="M410.259 176v32" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_XoopsTpl_Legacy_XoopsTpl_2" marker-start="url(#mermaid-i94l5n9v9d7_class-extensionStart)" d="M116.047 517v20.667c0 20.666 0 62 .667 93.333.666 31.333 2 52.667 2.666 63.333l.667 10.667" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_Legacy_RenderSystem_Legacy_XoopsTpl_3" marker-start="url(#mermaid-i94l5n9v9d7_class-aggregationStart)" d="m269.484 631.144-1.055 1.643c-1.055 1.643-3.166 4.928-13.361 17.237-10.196 12.309-28.477 33.643-37.617 44.309L208.311 705" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_XCube_RenderTarget_Legacy_RenderTargetMain_4" marker-start="url(#mermaid-i94l5n9v9d7_class-extensionStart)" d="m280.554 923.39-7.155 6.268c-7.155 6.269-21.465 18.805-28.62 31.24-7.156 12.435-7.156 24.769-7.156 30.935V998" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_XCube_RenderTarget_Legacy_ThemeRenderTarget_5" marker-start="url(#mermaid-i94l5n9v9d7_class-extensionStart)" d="m559.964 923.39 7.155 6.268c7.156 6.269 21.466 18.805 28.621 29.24 7.155 10.435 7.155 18.769 7.155 22.935V986" class="edge-thickness-normal edge-pattern-solid relation"/><path id="id_Legacy_RenderSystem_XCube_RenderTarget_6" marker-end="url(#mermaid-i94l5n9v9d7_class-dependencyEnd)" d="m419.168 616 .182 4.167c.182 4.166.545 12.5.727 19.833.182 7.333.182 13.667.182 16.833V660" class="edge-thickness-normal edge-pattern-dashed relation"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="24" class="label" transform="translate(0 -12)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel" style="display:inline-block"/></div></foreignObject></g></g><g class="nodes"><g id="classId-XCube_RenderSystem-112" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-93.069-75H93.07V75H-93.07" transform="translate(410.26 83)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-93.069-75H93.07M-93.07-75H93.07m0 0V75m0-150V75m0 0H-93.07M93.07 75H-93.07m0 0V-75m0 150V-75" transform="translate(410.26 83)"/></g><g class="label-group text"><foreignObject width="162.137" height="24" class="label" style="font-weight:bolder" transform="translate(329.19 20)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:214px;text-align:center"><span class="nodeLabel markdown-node-label"><p>XCube_RenderSystem</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="75.425" height="24" class="label" transform="translate(329.19 98)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:131px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+prepare()</p></span></div></foreignObject><foreignObject width="66.938" height="24" class="label" transform="translate(329.19 122)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:123px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+render()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-93.069-27H93.07M-93.07-27H93.07M-93.069-3H93.07M-93.07-3H93.07" class="divider" transform="translate(410.26 83)"/></g><g id="classId-Legacy_RenderSystem-113" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-159.619-204H159.62v408H-159.62" transform="translate(410.26 412)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-159.619-204H159.62m-319.238 0H159.62m0 0v408m0-408v408m0 0H-159.62m319.238 0H-159.62m0 0v-408m0 408v-408" transform="translate(410.26 412)"/></g><g class="label-group text"><foreignObject width="165.3" height="24" class="label" style="font-weight:bolder" transform="translate(327.61 220)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:219px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_RenderSystem</p></span></div></foreignObject></g><g class="members-group text"><foreignObject width="212.588" height="24" class="label" transform="translate(262.64 268)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:279px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-mXoopsTpl: Legacy_XoopsTpl</p></span></div></foreignObject><foreignObject width="161.512" height="24" class="label" transform="translate(262.64 292)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:225px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-mThemeRenderTarget</p></span></div></foreignObject><foreignObject width="149" height="24" class="label" transform="translate(262.64 316)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:212px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-mMainRenderTarget</p></span></div></foreignObject><foreignObject width="123.138" height="24" class="label" transform="translate(262.64 340)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:188px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-_mContentsData</p></span></div></foreignObject><foreignObject width="170.15" height="24" class="label" transform="translate(262.64 364)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:237px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-_mIsActiveBanner: bool</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="75.425" height="24" class="label" transform="translate(262.64 412)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:131px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+prepare()</p></span></div></foreignObject><foreignObject width="66.938" height="24" class="label" transform="translate(262.64 436)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:123px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+render()</p></span></div></foreignObject><foreignObject width="102.375" height="24" class="label" transform="translate(262.64 460)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:158px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+renderMain()</p></span></div></foreignObject><foreignObject width="104.713" height="24" class="label" transform="translate(262.64 484)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:164px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+renderBlock()</p></span></div></foreignObject><foreignObject width="114.9" height="24" class="label" transform="translate(262.64 508)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:171px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+renderTheme()</p></span></div></foreignObject><foreignObject width="157.238" height="24" class="label" transform="translate(262.64 532)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:219px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+createRenderTarget()</p></span></div></foreignObject><foreignObject width="185.15" height="24" class="label" transform="translate(262.64 556)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:246px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+getThemeRenderTarget()</p></span></div></foreignObject><foreignObject width="189.7" height="24" class="label" transform="translate(262.64 580)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:255px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-_commonPrepareRender()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-159.619-156H159.62m-319.238 0H159.62M-159.619-12H159.62m-319.238 0H159.62" class="divider" transform="translate(410.26 412)"/></g><g id="classId-Legacy_XoopsTpl-114" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-118.047-96h236.094V96h-236.094" transform="translate(126.047 801)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-118.047-96h236.094m-236.094 0h236.094m0 0V96m0-192V96m0 0h-236.094m236.094 0h-236.094m0 0V-96m0 192V-96" transform="translate(126.047 801)"/></g><g class="label-group text"><foreignObject width="128.113" height="24" class="label" style="font-weight:bolder" transform="translate(61.99 717)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:177px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_XoopsTpl</p></span></div></foreignObject></g><g class="members-group text"><foreignObject width="135.938" height="24" class="label" transform="translate(20 765)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:204px;text-align:center"><span class="nodeLabel markdown-node-label"><p>-_mContextReserve</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="64.675" height="24" class="label" transform="translate(20 813)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:123px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+assign()</p></span></div></foreignObject><foreignObject width="114.05" height="24" class="label" transform="translate(20 837)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:178px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+assign_by_ref()</p></span></div></foreignObject><foreignObject width="148.038" height="24" class="label" transform="translate(20 861)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:213px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+get_template_vars()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-118.047-48h236.094m-236.094 0h236.094M-118.047 0h236.094m-236.094 0h236.094" class="divider" transform="translate(126.047 801)"/></g><g id="classId-XoopsTpl-115" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-64.39-87H64.39V87H-64.39" transform="translate(116.047 412)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-64.39-87H64.39m-128.78 0H64.39m0 0V87m0-174V87m0 0H-64.39m128.78 0H-64.39m0 0V-87m0 174V-87" transform="translate(116.047 412)"/></g><g class="label-group text"><foreignObject width="69.838" height="24" class="label" style="font-weight:bolder" transform="translate(81.128 337)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:116px;text-align:center"><span class="nodeLabel markdown-node-label"><p>XoopsTpl</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="55.85" height="24" class="label" transform="translate(63.656 415)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:113px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+fetch()</p></span></div></foreignObject><foreignObject width="69.863" height="24" class="label" transform="translate(63.656 439)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:127px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+display()</p></span></div></foreignObject><foreignObject width="64.675" height="24" class="label" transform="translate(63.656 463)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:123px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+assign()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-64.39-39H64.39m-128.78 0H64.39M-64.39-15H64.39m-128.78 0H64.39" class="divider" transform="translate(116.047 412)"/></g><g id="classId-XCube_RenderTarget-116" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-126.166-135h252.332v270h-252.332" transform="translate(420.26 801)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-126.166-135h252.332m-252.332 0h252.332m0 0v270m0-270v270m0 0h-252.332m252.332 0h-252.332m0 0v-270m0 270v-270" transform="translate(420.26 801)"/></g><g class="label-group text"><foreignObject width="156.163" height="24" class="label" style="font-weight:bolder" transform="translate(342.178 678)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:205px;text-align:center"><span class="nodeLabel markdown-node-label"><p>XCube_RenderTarget</p></span></div></foreignObject></g><g class="methods-group text"><foreignObject width="113.463" height="24" class="label" transform="translate(306.094 756)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:171px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+getAttributes()</p></span></div></foreignObject><foreignObject width="106.675" height="24" class="label" transform="translate(306.094 780)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:162px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+getAttribute()</p></span></div></foreignObject><foreignObject width="104.037" height="24" class="label" transform="translate(306.094 804)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:161px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setAttribute()</p></span></div></foreignObject><foreignObject width="150.25" height="24" class="label" transform="translate(306.094 828)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:209px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+getTemplateName()</p></span></div></foreignObject><foreignObject width="147.625" height="24" class="label" transform="translate(306.094 852)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:208px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setTemplateName()</p></span></div></foreignObject><foreignObject width="83.8" height="24" class="label" transform="translate(306.094 876)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:145px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+setResult()</p></span></div></foreignObject><foreignObject width="86.425" height="24" class="label" transform="translate(306.094 900)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:146px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+getResult()</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-126.166-87h252.332m-252.332 0h252.332M-126.166-63h252.332m-252.332 0h252.332" class="divider" transform="translate(420.26 801)"/></g><g id="classId-Legacy_RenderTargetMain-117" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-153.684-60h307.368V60h-307.368" transform="translate(237.623 1058)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-153.684-60h307.368m-307.368 0h307.368m0 0V60m0-120V60m0 0h-307.368m307.368 0h-307.368m0 0V-60m0 120V-60" transform="translate(237.623 1058)"/></g><g class="label-group text"><foreignObject width="197.463" height="24" class="label" style="font-weight:bolder" transform="translate(138.892 1010)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:245px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_RenderTargetMain</p></span></div></foreignObject></g><g class="members-group text"><foreignObject width="184.637" height="24" class="label" transform="translate(95.939 1058)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:247px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+legacy_buffertype: MAIN</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-153.684-12h307.368m-307.368 0h307.368M-153.684 36h307.368m-307.368 0h307.368" class="divider" transform="translate(237.623 1058)"/></g><g id="classId-Legacy_ThemeRenderTarget-118" class="node default"><g class="basic label-container"><path fill="#fff" stroke-width="0" d="M-161.588-72h323.176V72h-323.176" transform="translate(602.895 1058)"/><path fill="none" stroke="#ddd" stroke-width="1.3" d="M-161.588-72h323.176m-323.176 0h323.176m0 0V72m0-144V72m0 0h-323.176m323.176 0h-323.176m0 0V-72m0 144V-72" transform="translate(602.895 1058)"/></g><g class="label-group text"><foreignObject width="210.3" height="24" class="label" style="font-weight:bolder" transform="translate(497.745 998)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:259px;text-align:center"><span class="nodeLabel markdown-node-label"><p>Legacy_ThemeRenderTarget</p></span></div></foreignObject></g><g class="members-group text"><foreignObject width="194.025" height="24" class="label" transform="translate(453.308 1046)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:259px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+legacy_buffertype: THEME</p></span></div></foreignObject><foreignObject width="129.75" height="24" class="label" transform="translate(453.308 1070)"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:191px;text-align:center"><span class="nodeLabel markdown-node-label"><p>+isFileTheme: true</p></span></div></foreignObject></g><path fill="none" stroke-width="1.3" d="M-161.588-24h323.176m-323.176 0h323.176M-161.588 48h323.176m-323.176 0h323.176" class="divider" transform="translate(602.895 1058)"/></g></g></g></svg>
</p>

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L107-L641" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L107-L641</a></code>   
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderTarget.class.php#L10-L79" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderTarget.class.php#L10-L79</a></code>


## Render System Architecture

The rendering system operates within a hierarchical structure where the Legacy_Controller initializes the rendering process, and the Legacy_RenderSystem handles the actual rendering through various specialized components.

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-5oxgyvv6a4c" aria-roledescription="flowchart-v2" class="xcl-diagram flowchart" style="max-width:1445.1624755859375px" viewBox="0 0 1445.162 590"><g class="root"><g class="edgePaths"><path id="L_A_B_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M788.331 62v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_B_C1_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="m680.706 154.633-41.729 6.061c-41.729 6.061-125.187 18.184-166.917 27.745C430.331 198 430.331 205 430.331 208.5v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_B_C2_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="m895.956 154.633 41.729 6.061c41.73 6.061 125.188 18.184 166.917 27.745s41.729 16.561 41.729 20.061v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C1_D1_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="m327.188 260.86-32.861 5.69c-32.86 5.69-98.581 17.07-131.442 26.26-32.86 9.19-32.86 16.19-32.86 19.69v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C1_D2_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M430.331 270v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C1_D3_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="m533.475 261.953 29.973 5.508c29.973 5.508 89.919 16.523 119.892 25.531S713.313 309 713.313 312.5v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C2_E1_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="m1088.331 257.886-24.1 6.186c-24.1 6.186-72.3 18.557-96.4 28.242-24.1 9.686-24.1 16.686-24.1 20.186v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C2_E2_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M1146.331 270v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C2_E3_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="m1204.331 257.441 25.143 6.259c25.143 6.26 75.428 18.78 100.571 28.54 25.142 9.76 25.142 16.76 25.142 20.26v3.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_E1_F1_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M943.731 374v4.167c0 4.166 0 12.5 15.588 20.667 15.589 8.168 46.765 16.17 62.353 20.171l15.589 4.001" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_E2_F1_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M1146.331 374v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_E3_F1_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M1355.187 374v4.167c0 4.166 0 12.5-16.088 20.672s-48.265 16.183-64.353 20.189l-16.089 4.006" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_F1_G_0" marker-end="url(#mermaid-5oxgyvv6a4c_flowchart-v2-pointEnd)" d="M1146.331 478v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g></g><g class="nodes"><g id="flowchart-A-0" class="node default"><path d="M-92.806-27H92.807v54H-92.806z" class="basic label-container" transform="translate(788.331 35)"/><g class="label" transform="translate(725.525 23)"><rect/><foreignObject width="125.613" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_Controller</p></span></div></foreignObject></g></g><g id="flowchart-B-1" class="node default"><path d="M-107.625-27h215.25v54h-215.25z" class="basic label-container" transform="translate(788.331 139)"/><g class="label" transform="translate(710.706 127)"><rect/><foreignObject width="155.25" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_RenderSystem</p></span></div></foreignObject></g></g><g id="flowchart-C1-3" class="node default"><path d="M-103.144-27h206.288v54h-206.288z" class="basic label-container" transform="translate(430.331 243)"/><g class="label" transform="translate(357.188 231)"><rect/><foreignObject width="146.288" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>createRenderTarget()</p></span></div></foreignObject></g></g><g id="flowchart-C2-5" class="node default"><path d="M-58-27H58v54H-58z" class="basic label-container" transform="translate(1146.331 243)"/><g class="label" transform="translate(1118.331 231)"><rect/><foreignObject width="56" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>render()</p></span></div></foreignObject></g></g><g id="flowchart-D1-7" class="node default"><path d="M-122.025-27h244.05v54h-244.05z" class="basic label-container" transform="translate(130.025 347)"/><g class="label" transform="translate(38 335)"><rect/><foreignObject width="184.05" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_RenderTargetMain</p></span></div></foreignObject></g></g><g id="flowchart-D2-9" class="node default"><path d="M-128.281-27h256.563v54h-256.563z" class="basic label-container" transform="translate(430.331 347)"/><g class="label" transform="translate(332.05 335)"><rect/><foreignObject width="196.563" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_ThemeRenderTarget</p></span></div></foreignObject></g></g><g id="flowchart-D3-11" class="node default"><path d="M-104.7-27h209.4v54h-209.4z" class="basic label-container" transform="translate(713.313 347)"/><g class="label" transform="translate(638.612 335)"><rect/><foreignObject width="149.4" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Other Render Targets</p></span></div></foreignObject></g></g><g id="flowchart-E1-13" class="node default"><path d="M-75.719-27H75.719v54H-75.719z" class="basic label-container" transform="translate(943.731 347)"/><g class="label" transform="translate(898.012 335)"><rect/><foreignObject width="91.438" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>renderMain()</p></span></div></foreignObject></g></g><g id="flowchart-E2-15" class="node default"><path d="M-76.881-27H76.882v54H-76.881z" class="basic label-container" transform="translate(1146.331 347)"/><g class="label" transform="translate(1099.45 335)"><rect/><foreignObject width="93.763" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>renderBlock()</p></span></div></foreignObject></g></g><g id="flowchart-E3-17" class="node default"><path d="M-81.975-27h163.95v54h-163.95z" class="basic label-container" transform="translate(1355.187 347)"/><g class="label" transform="translate(1303.212 335)"><rect/><foreignObject width="103.95" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>renderTheme()</p></span></div></foreignObject></g></g><g id="flowchart-F1-19" class="node default"><path d="M-114.981-27h229.963v54h-229.963z" class="basic label-container" transform="translate(1146.331 451)"/><g class="label" transform="translate(1061.35 439)"><rect/><foreignObject width="169.963" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Smarty Template Engine</p></span></div></foreignObject></g></g><g id="flowchart-G-25" class="node default"><path d="M-78.225-27h156.45v54h-156.45z" class="basic label-container" transform="translate(1146.331 555)"/><g class="label" transform="translate(1098.106 543)"><rect/><foreignObject width="96.45" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>HTML Output</p></span></div></foreignObject></g></g></g></g></svg>
</p>

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L107-L641" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L107-L641</a></code>   
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L50-L1029" target="_blank">/html/modules/legacy/kernel/Legacy_Controller.class.php#L50-L1029</a></code>

## Key Components

### `Legacy_XoopsTpl Class`

This class extends the standard XoopsTpl class to provide specialized functionality for the Legacy framework. It handles context-aware variable assignments and serves as the bridge between the render system and the Smarty template engine.

```php
class Legacy_XoopsTpl extends XoopsTpl
{
    // Special handling of context-aware variables
    public $_mContextReserve = ['xoops_pagetitle' => 'legacy_pagetitle'];
    
    public function assign($tpl_var, $value = null) {
        // Special handling of context variables
    }
    
    // Other overridden methods
}
```

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L29-L98" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L29-L98</a></code>


<div class="table-wrapper">
<table><thead><tr><th>Target Type</th><th>Constant</th><th>Description</th></tr></thead><tbody><tr><td>Buffer</td><td>LEGACY_RENDER_TARGET_TYPE_BUFFER</td><td>Generic buffer type</td></tr><tr><td>Theme</td><td>LEGACY_RENDER_TARGET_TYPE_THEME</td><td>For rendering entire theme</td></tr><tr><td>Block</td><td>LEGACY_RENDER_TARGET_TYPE_BLOCK</td><td>For rendering blocks</td></tr><tr><td>Main</td><td>LEGACY_RENDER_TARGET_TYPE_MAIN</td><td>For rendering main content</td></tr></tbody></table>
</div>

Each render target type has specific handling in the render() method which delegates to specialized rendering methods.

## Rendering Process

### Initialization


The rendering process begins when the Legacy_Controller initializes the RenderSystem and prepares it for rendering:


<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="xcl_render_ini_process" aria-roledescription="sequence" class="xcl-diagram flowchart" style="max-width:949px" viewBox="-50 -10 949 483"><rect width="150" height="65" x="699" y="397" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="774" y="429.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="774" dy="0">&quot;XCube_Context&quot;</tspan></text><rect width="158" height="65" x="491" y="397" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="570" y="429.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="570" dy="0">&quot;Legacy_XoopsTpl&quot;</tspan></text><rect width="200" height="65" x="215" y="397" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="315" y="429.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="315" dy="0">&quot;Legacy_RenderSystem&quot;</tspan></text><rect width="165" height="65" y="397" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="82.5" y="429.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="82.5" dy="0">&quot;Legacy_Controller&quot;</tspan></text><path id="actor113" stroke="#999" stroke-width=".5" d="M774 65v332" class="actor-line 200"/><g id="root-113"><rect width="150" height="65" x="699" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="774" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="774" dy="0">&quot;XCube_Context&quot;</tspan></text></g><path id="actor112" stroke="#999" stroke-width=".5" d="M570 65v332" class="actor-line 200"/><g id="root-112"><rect width="158" height="65" x="491" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="570" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="570" dy="0">&quot;Legacy_XoopsTpl&quot;</tspan></text></g><path id="actor111" stroke="#999" stroke-width=".5" d="M315 65v332" class="actor-line 200"/><g id="root-111"><rect width="200" height="65" x="215" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="315" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="315" dy="0">&quot;Legacy_RenderSystem&quot;</tspan></text></g><path id="actor110" stroke="#999" stroke-width=".5" d="M82.5 65v332" class="actor-line 200"/><g id="root-110"><rect width="165" height="65" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="82.5" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="82.5" dy="0">&quot;Legacy_Controller&quot;</tspan></text></g><text x="197" y="80" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">prepare(&amp;controller)</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M83.5 117H311" class="messageLine0" style="fill:none"/><text x="441" y="132" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">new Legacy_XoopsTpl()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M316 169h250" class="messageLine0" style="fill:none"/><text x="441" y="184" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">setup functions</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M316 221h250" class="messageLine0" style="fill:none"/><text x="441" y="236" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">assign common variables</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M316 273h250" class="messageLine0" style="fill:none"/><text x="543" y="288" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">get attributes (sitename, pagetitle, etc)</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M316 325h454" class="messageLine0" style="fill:none"/><text x="441" y="340" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">assign site variables</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M316 377h250" class="messageLine0" style="fill:none"/></svg>
</p>

### The Main Rendering Methods

The Legacy_RenderSystem provides three primary rendering methods:

- `renderMain()` - Renders the main content area
- `renderBlock()` - Renders individual block content
- `renderTheme()` - Renders the complete theme with all components


## Main Content Rendering

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="xcl_render_main_content" aria-roledescription="flowchart-v2" class="xcl-diagram flowchart" style="max-width:276px" viewBox="0 0 276 614"><marker id="xcl_render_main_content_flowchart-v2-pointEnd" class="marker flowchart-v2" markerHeight="8" markerUnits="userSpaceOnUse" markerWidth="8" orient="auto" refX="5" refY="5" viewBox="0 0 10 10"><path d="m0 0 10 5-10 5z" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><g class="root"><g class="edgePaths"><path id="L_A_B_0" marker-end="url(#xcl_render_main_content_flowchart-v2-pointEnd)" d="M138 62v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_B_C_0" marker-end="url(#xcl_render_main_content_flowchart-v2-pointEnd)" d="M138 166v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C_D_0" marker-end="url(#xcl_render_main_content_flowchart-v2-pointEnd)" d="M138 270v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_D_E_0" marker-end="url(#xcl_render_main_content_flowchart-v2-pointEnd)" d="M138 398v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_E_F_0" marker-end="url(#xcl_render_main_content_flowchart-v2-pointEnd)" d="M138 502v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g></g><g class="nodes"><g id="flowchart-A-0" class="node default"><path d="M-75.719-27H75.719v54H-75.719z" class="basic label-container" transform="translate(138 35)"/><g class="label" transform="translate(92.281 23)"><rect/><foreignObject width="91.438" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>renderMain()</p></span></div></foreignObject></g></g><g id="flowchart-B-1" class="node default"><path d="M-121.65-27h243.3v54h-243.3z" class="basic label-container" transform="translate(138 139)"/><g class="label" transform="translate(46.35 127)"><rect/><foreignObject width="183.3" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>_commonPrepareRender()</p></span></div></foreignObject></g></g><g id="flowchart-C-3" class="node default"><path d="M-122.394-27h244.788v54h-244.788z" class="basic label-container" transform="translate(138 243)"/><g class="label" transform="translate(45.606 231)"><rect/><foreignObject width="184.788" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Get Attributes from Target</p></span></div></foreignObject></g></g><g id="flowchart-D-5" class="node default"><path d="M-130-39h260v78h-260z" class="basic label-container" transform="translate(138 359)"/><g class="label" transform="translate(38 335)"><rect/><foreignObject width="200" height="48"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Assign Variables to Template</p></span></div></foreignObject></g></g><g id="flowchart-E-7" class="node default"><path d="M-83.306-27H83.307v54H-83.306z" class="basic label-container" transform="translate(138 475)"/><g class="label" transform="translate(84.694 463)"><rect/><foreignObject width="106.613" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Fetch Template</p></span></div></foreignObject></g></g><g id="flowchart-F-9" class="node default"><path d="M-98.175-27h196.35v54h-196.35z" class="basic label-container" transform="translate(138 579)"/><g class="label" transform="translate(69.825 567)"><rect/><foreignObject width="136.35" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Set Result to Target</p></span></div></foreignObject></g></g></g></g></svg>

</p>

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L359-L386" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L359-L386</a></code>

## Block Rendering

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="xcl_render_main_block" aria-roledescription="flowchart-v2" class="xcl-diagram flowchart" style="max-width:276px" viewBox="0 0 276 846"><marker id="xcl_render_main_block_flowchart-v2-pointEnd" class="marker flowchart-v2" markerHeight="8" markerUnits="userSpaceOnUse" markerWidth="8" orient="auto" refX="5" refY="5" viewBox="0 0 10 10"><path d="m0 0 10 5-10 5z" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><g class="root"><g class="edgePaths"><path id="L_A_B_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 62v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_B_C_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 166v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C_D_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 270v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_D_E_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 398v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_E_F_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 526v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_F_G_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 630v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_G_H_0" marker-end="url(#xcl_render_main_block_flowchart-v2-pointEnd)" d="M138 734v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g></g><g class="nodes"><g id="flowchart-A-0" class="node default"><path d="M-76.881-27H76.882v54H-76.881z" class="basic label-container" transform="translate(138 35)"/><g class="label" transform="translate(91.119 23)"><rect/><foreignObject width="93.763" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>renderBlock()</p></span></div></foreignObject></g></g><g id="flowchart-B-1" class="node default"><path d="M-121.65-27h243.3v54h-243.3z" class="basic label-container" transform="translate(138 139)"/><g class="label" transform="translate(46.35 127)"><rect/><foreignObject width="183.3" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>_commonPrepareRender()</p></span></div></foreignObject></g></g><g id="flowchart-C-3" class="node default"><path d="M-122.394-27h244.788v54h-244.788z" class="basic label-container" transform="translate(138 243)"/><g class="label" transform="translate(45.606 231)"><rect/><foreignObject width="184.788" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Get Attributes from Target</p></span></div></foreignObject></g></g><g id="flowchart-D-5" class="node default"><path d="M-130-39h260v78h-260z" class="basic label-container" transform="translate(138 359)"/><g class="label" transform="translate(38 335)"><rect/><foreignObject width="200" height="48"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Assign Variables to Template</p></span></div></foreignObject></g></g><g id="flowchart-E-7" class="node default"><path d="M-130-39h260v78h-260z" class="basic label-container" transform="translate(138 487)"/><g class="label" transform="translate(38 463)"><rect/><foreignObject width="200" height="48"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Call mBeginRender Delegate</p></span></div></foreignObject></g></g><g id="flowchart-F-9" class="node default"><path d="M-71.338-27H71.337v54H-71.338z" class="basic label-container" transform="translate(138 603)"/><g class="label" transform="translate(96.662 591)"><rect/><foreignObject width="82.675" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>fetchBlock()</p></span></div></foreignObject></g></g><g id="flowchart-G-11" class="node default"><path d="M-98.175-27h196.35v54h-196.35z" class="basic label-container" transform="translate(138 707)"/><g class="label" transform="translate(69.825 695)"><rect/><foreignObject width="136.35" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Set Result to Target</p></span></div></foreignObject></g></g><g id="flowchart-H-13" class="node default"><path d="M-116.963-27h233.925v54h-233.925z" class="basic label-container" transform="translate(138 811)"/><g class="label" transform="translate(51.037 799)"><rect/><foreignObject width="173.925" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Reset Template Variables</p></span></div></foreignObject></g></g></g></g></svg>
</p>

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L297-L318" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L297-L318</a></code>


## Theme Rendering

The theme rendering process assembles all components (main content, blocks, etc.) into the final HTML output:

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="xcl_render_main_theme" aria-roledescription="flowchart-v2" class="xcl-diagram flowchart" style="max-width:481.32501220703125px" viewBox="0 0 481.325 1271.725"><marker id="xcl_render_main_theme_flowchart-v2-pointEnd" class="marker flowchart-v2" markerHeight="8" markerUnits="userSpaceOnUse" markerWidth="8" orient="auto" refX="5" refY="5" viewBox="0 0 10 10"><path d="m0 0 10 5-10 5z" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><g class="root"><g class="edgePaths"><path id="L_A_B_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 62v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_B_C_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 166v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C_D_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 270v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_D_E_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 374v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_E_F_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 478v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_F_G_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 582v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_G_H1_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 710v4.167c0 4.166 0 12.5.071 20.25.07 7.75.21 14.917.281 18.5l.07 3.584" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_H1_I1_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="m187.731 865.275-15.063 12.575c-15.064 12.575-45.191 37.725-60.254 55.8-15.064 18.075-15.064 29.075-15.064 34.575v5.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_H1_I2_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="m265.631 865.275 14.897 12.575c14.897 12.575 44.691 37.725 59.588 55.8 14.896 18.075 14.896 29.075 14.896 34.575v5.5" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_I1_J_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M97.35 1031.725v4.167c0 4.166 0 12.5 7.79 20.536 7.791 8.037 23.372 15.777 31.162 19.647l7.79 3.87" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_I2_J_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M355.012 1031.725v4.167c0 4.166 0 12.5-7.79 20.536-7.79 8.037-23.371 15.777-31.161 19.647l-7.791 3.87" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_J_K_0" marker-end="url(#xcl_render_main_theme_flowchart-v2-pointEnd)" d="M226.181 1159.725v46" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="22.6" height="24" class="label" transform="translate(86.05 928.725)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>Yes</p></span></div></foreignObject></g><g class="edgeLabel"><foreignObject width="21.35" height="24" class="label" transform="translate(344.337 928.725)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>No</p></span></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g><g class="edgeLabel"><foreignObject width="0" height="0" class="label"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"/></div></foreignObject></g></g><g class="nodes"><g id="flowchart-A-0" class="node default"><path d="M-81.975-27h163.95v54h-163.95z" class="basic label-container" transform="translate(226.181 35)"/><g class="label" transform="translate(174.206 23)"><rect/><foreignObject width="103.95" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>renderTheme()</p></span></div></foreignObject></g></g><g id="flowchart-B-1" class="node default"><path d="M-121.65-27h243.3v54h-243.3z" class="basic label-container" transform="translate(226.181 139)"/><g class="label" transform="translate(134.531 127)"><rect/><foreignObject width="183.3" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>_commonPrepareRender()</p></span></div></foreignObject></g></g><g id="flowchart-C-3" class="node default"><path d="M-121.169-27h242.338v54h-242.338z" class="basic label-container" transform="translate(226.181 243)"/><g class="label" transform="translate(135.012 231)"><rect/><foreignObject width="182.338" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Prepare Meta Information</p></span></div></foreignObject></g></g><g id="flowchart-D-5" class="node default"><path d="M-110.106-27h220.213v54h-220.213z" class="basic label-container" transform="translate(226.181 347)"/><g class="label" transform="translate(146.075 335)"><rect/><foreignObject width="160.213" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Create Module Header</p></span></div></foreignObject></g></g><g id="flowchart-E-7" class="node default"><path d="M-112.95-27h225.9v54h-225.9z" class="basic label-container" transform="translate(226.181 451)"/><g class="label" transform="translate(143.231 439)"><rect/><foreignObject width="165.9" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Assign Theme Variables</p></span></div></foreignObject></g></g><g id="flowchart-F-9" class="node default"><path d="M-113.363-27h226.725v54h-226.725z" class="basic label-container" transform="translate(226.181 555)"/><g class="label" transform="translate(142.819 543)"><rect/><foreignObject width="166.725" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Process Block Locations</p></span></div></foreignObject></g></g><g id="flowchart-G-11" class="node default"><path d="M-130-39h260v78h-260z" class="basic label-container" transform="translate(226.181 671)"/><g class="label" transform="translate(126.181 647)"><rect/><foreignObject width="200" height="48"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Call mBeginRender Delegate</p></span></div></foreignObject></g></g><g id="flowchart-H1-13" class="node default"><path d="m226.18 903.725 71.864-71.862L226.18 760l-71.862 71.863z" class="label-container"/><g class="label" transform="translate(181.319 819.862)"><rect/><foreignObject width="89.725" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>isFileTheme?</p></span></div></foreignObject></g></g><g id="flowchart-I1-15" class="node default"><path d="M-89.35-27h178.7v54h-178.7z" class="basic label-container" transform="translate(97.35 1004.725)"/><g class="label" transform="translate(38 992.725)"><rect/><foreignObject width="118.7" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Fetch Theme File</p></span></div></foreignObject></g></g><g id="flowchart-I2-17" class="node default"><path d="M-118.313-27h236.625v54h-236.625z" class="basic label-container" transform="translate(355.012 1004.725)"/><g class="label" transform="translate(266.7 992.725)"><rect/><foreignObject width="176.625" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Fetch Database Template</p></span></div></foreignObject></g></g><g id="flowchart-J-19" class="node default"><path d="M-130-39h260v78h-260z" class="basic label-container" transform="translate(226.181 1120.725)"/><g class="label" transform="translate(126.181 1096.725)"><rect/><foreignObject width="200" height="48"><div style="display:table;white-space:break-spaces;line-height:1.5;max-width:200px;text-align:center;width:200px"><span class="nodeLabel"><p>Add Debug Console if Needed</p></span></div></foreignObject></g></g><g id="flowchart-K-23" class="node default"><path d="M-98.175-27h196.35v54h-196.35z" class="basic label-container" transform="translate(226.181 1236.725)"/><g class="label" transform="translate(158.006 1224.725)"><rect/><foreignObject width="136.35" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Set Result to Target</p></span></div></foreignObject></g></g></g></g></svg>
</p>

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L387-L487" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L387-L487</a></code>


## Creating Render Targets


The system provides a factory method createRenderTarget() to create appropriate render target objects based on the requested type:

```php
public function &createRenderTarget($type = LEGACY_RENDER_TARGET_TYPE_MAIN, $option = null)
{
    $renderTarget = null;
    switch ($type) {
        case XCUBE_RENDER_TARGET_TYPE_MAIN:
            $renderTarget = new Legacy_RenderTargetMain();
            break;
        case LEGACY_RENDER_TARGET_TYPE_BLOCK:
            $renderTarget = new XCube_RenderTarget();
            $renderTarget->setAttribute('legacy_buffertype', LEGACY_RENDER_TARGET_TYPE_BLOCK);
            break;
        default:
            $renderTarget = new XCube_RenderTarget();
            break;
    }
    return $renderTarget;
}
```

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L610-L629" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L610-L629</a></code>


## Template Variables 

### Context

The Legacy_RenderSystem manages the transfer of variables between the application context and the template system. This includes common site variables, module-specific variables, and theme-related settings.

### Common Template Variables

<div class="table-wrapper">
<table><thead><tr><th>Variable Name</th><th>Description</th><th>Source</th></tr></thead><tbody><tr><td>xoops_sitename</td><td>Site name</td><td>Context attribute 'legacy_sitename'</td></tr><tr><td>xoops_pagetitle</td><td>Page title</td><td>Context attribute 'legacy_pagetitle'</td></tr><tr><td>xoops_theme</td><td>Theme name</td><td>Context theme name</td></tr><tr><td>xoops_imageurl</td><td>Theme image URL</td><td>Theme path</td></tr><tr><td>xoops_themecss</td><td>Theme CSS URL</td><td>CSS URL for current theme</td></tr><tr><td>xoops_module_header</td><td>Combined JS/CSS headers</td><td>Aggregated by the system</td></tr></tbody></table>
</div>

### Context-Aware Variable Assignment

The system uses a special mechanism through Legacy_XoopsTpl to synchronize template variables with context attributes:

<svg xmlns="http://www.w3.org/2000/svg" id="xcl_render_main_context" aria-roledescription="flowchart-v2" class="xcl-diagram flowchart" style="max-width:1582.33740234375px" viewBox="0 0 1582.337 70">
<marker id="xcl_render_main_context_flowchart-v2-pointEnd" class="marker flowchart-v2" markerHeight="8" markerUnits="userSpaceOnUse" markerWidth="8" orient="auto" refX="5" refY="5" viewBox="0 0 10 10"><path d="m0 0 10 5-10 5z" class="arrowMarkerPath" style="stroke-width:1;stroke-dasharray:1,0"/></marker><g class="root"><g class="edgePaths"><path id="L_A_B_0" marker-end="url(#xcl_render_main_context_flowchart-v2-pointEnd)" d="M199.075 35H338.162" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_C_D_0" marker-end="url(#xcl_render_main_context_flowchart-v2-pointEnd)" d="M936.587 35h99.738" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_B_C_0" marker-end="url(#xcl_render_main_context_flowchart-v2-pointEnd)" marker-start="url(#xcl_render_main_context_flowchart-v2-pointStart)" d="M513.687 35h239" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/><path id="L_D_E_0" marker-end="url(#xcl_render_main_context_flowchart-v2-pointEnd)" d="M1231.812 35H1387.862" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link"/></g><g class="edgeLabels"><g class="edgeLabel"><foreignObject width="93.088" height="24" class="label" transform="translate(224.075 23)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>setAttribute()</p></span></div></foreignObject></g><g class="edgeLabel"><foreignObject width="53.737" height="24" class="label" transform="translate(961.587 23)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>assign()</p></span></div></foreignObject></g><g class="edgeLabel"><foreignObject width="197" height="24" class="label" transform="translate(534.687 23)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>_mContextReserve mapping</p></span></div></foreignObject></g><g class="edgeLabel"><foreignObject width="110.05" height="24" class="label" transform="translate(1256.812 23)"><div class="labelBkg" style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="edgeLabel"><p>fetch()/display()</p></span></div></foreignObject></g></g><g class="nodes"><g id="flowchart-A-0" class="node default"><path d="M-95.537-27H95.538v54H-95.537z" class="basic label-container" transform="translate(103.537 35)"/><g class="label" transform="translate(38 23)"><rect/><foreignObject width="131.075" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Module/Controller</p></span></div></foreignObject></g></g><g id="flowchart-B-1" class="node default"><path d="M-83.763-27H83.762v54H-83.763z" class="basic label-container" transform="translate(425.925 35)"/><g class="label" transform="translate(372.162 23)"><rect/><foreignObject width="107.525" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>XCube_Context</p></span></div></foreignObject></g></g><g id="flowchart-C-2" class="node default"><path d="M-89.95-27h179.9v54h-179.9z" class="basic label-container" transform="translate(846.637 35)"/><g class="label" transform="translate(786.687 23)"><rect/><foreignObject width="119.9" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Legacy_XoopsTpl</p></span></div></foreignObject></g></g><g id="flowchart-D-3" class="node default"><path d="M-95.744-27H95.744v54H-95.744z" class="basic label-container" transform="translate(1136.069 35)"/><g class="label" transform="translate(1070.325 23)"><rect/><foreignObject width="131.488" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Template Variables</p></span></div></foreignObject></g></g><g id="flowchart-E-7" class="node default"><path d="M-91.237-27H91.238v54H-91.237z" class="basic label-container" transform="translate(1483.1 35)"/><g class="label" transform="translate(1421.862 23)"><rect/><foreignObject width="122.475" height="24"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center"><span class="nodeLabel"><p>Rendered Output</p></span></div></foreignObject></g></g></g></g></svg>


<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L29-L98" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L29-L98</a></code>


### Integration with Controller

The `Legacy_Controller` initializes and manages the rendering process, including:

Creating Render Targets: The controller creates appropriate render targets for content
Executing View: The controller calls executeView() which initiates the rendering process
Caching: The controller handles caching of rendered content when appropriate

<p align="center">
<svg xmlns="http://www.w3.org/2000/svg" id="xcl_render_legacy_controller" aria-roledescription="sequence" style="max-width:1115px" class="xcl-diagram" viewBox="-50 -10 1115 989"><rect width="150" height="65" x="865" y="903" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="940" y="935.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="940" dy="0">&quot;Theme&quot;</tspan></text><rect width="150" height="65" x="665" y="903" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="740" y="935.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="740" dy="0">&quot;Module&quot;</tspan></text><rect width="200" height="65" x="415" y="903" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="515" y="935.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="515" dy="0">&quot;Legacy_RenderSystem&quot;</tspan></text><rect width="165" height="65" x="200" y="903" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="282.5" y="935.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="282.5" dy="0">&quot;Legacy_Controller&quot;</tspan></text><rect width="150" height="65" y="903" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"/><text x="75" y="935.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="75" dy="0">&quot;Browser&quot;</tspan></text><path id="actor8" stroke="#999" stroke-width=".5" d="M940 65v838" class="actor-line 200"/><g id="root-8"><rect width="150" height="65" x="865" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="940" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="940" dy="0">&quot;Theme&quot;</tspan></text></g><path id="actor7" stroke="#999" stroke-width=".5" d="M740 65v838" class="actor-line 200"/><g id="root-7"><rect width="150" height="65" x="665" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="740" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="740" dy="0">&quot;Module&quot;</tspan></text></g><path id="actor6" stroke="#999" stroke-width=".5" d="M515 65v838" class="actor-line 200"/><g id="root-6"><rect width="200" height="65" x="415" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="515" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="515" dy="0">&quot;Legacy_RenderSystem&quot;</tspan></text></g><path id="actor5" stroke="#999" stroke-width=".5" d="M282.5 65v838" class="actor-line 200"/><g id="root-5"><rect width="165" height="65" x="200" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="282.5" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="282.5" dy="0">&quot;Legacy_Controller&quot;</tspan></text></g><path id="actor4" stroke="#999" stroke-width=".5" d="M75 65v838" class="actor-line 200"/><g id="root-4"><rect width="150" height="65" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"/><text x="75" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400"><tspan x="75" dy="0">&quot;Browser&quot;</tspan></text></g><defs><marker id="arrowhead" markerHeight="12" markerUnits="userSpaceOnUse" markerWidth="12" orient="auto-start-reverse" refX="7.9" refY="5"><path d="m-1 0 11 5-10 5z"/></marker></defs><text x="177" y="80" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">HTTP Request</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M76 117h202.5" class="messageLine0" style="fill:none"/><text x="284" y="132" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">executeCommon()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 169c60-10 60 30 0 20" class="messageLine0" style="fill:none"/><text x="397" y="214" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">prepare()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 251H511" class="messageLine0" style="fill:none"/><text x="510" y="266" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">execute()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 303H736" class="messageLine0" style="fill:none"/><text x="513" y="318" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Create RenderTarget</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M739 355H286.5" class="messageLine1" style="stroke-dasharray:3,3;fill:none"/><text x="284" y="370" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">executeHeader()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 407c60-10 60 30 0 20" class="messageLine0" style="fill:none"/><text x="284" y="452" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">executeView()</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 489c60-10 60 30 0 20" class="messageLine0" style="fill:none"/><text x="397" y="534" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">render(mainTarget)</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 571H511" class="messageLine0" style="fill:none"/><text x="400" y="586" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Main Content</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M514 623H286.5" class="messageLine1" style="stroke-dasharray:3,3;fill:none"/><text x="397" y="638" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">render(themeTarget)</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M283.5 675H511" class="messageLine0" style="fill:none"/><text x="726" y="690" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Fetch theme template</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M516 727h420" class="messageLine0" style="fill:none"/><text x="729" y="742" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Theme HTML</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M939 779H519" class="messageLine1" style="stroke-dasharray:3,3;fill:none"/><text x="400" y="794" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">Complete HTML</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M514 831H286.5" class="messageLine1" style="stroke-dasharray:3,3;fill:none"/><text x="180" y="846" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-size:16px;font-weight:400" text-anchor="middle">HTTP Response</text><path stroke-width="2" marker-end="url(#arrowhead)" d="M281.5 883H79" class="messageLine1" style="stroke-dasharray:3,3;fill:none"/></svg>
</p>


<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacy/kernel/Legacy_Controller.class.php#L854-L972" target="_blank">/html/modules/legacy/kernel/Legacy_Controller.class.php#L854-L972</a></code>


## Legacy Compatibility Features

The Legacy_RenderSystem provides backward compatibility with XOOPS 2.x through:

1. Variable Mapping: Maintaining backward compatibility with legacy variable names
2. Template Structure: Supporting the XOOPS 2.x template structure
3. Block Rendering: Maintaining compatibility with legacy block rendering

These features allow existing themes and modules to work with XOOPSCube Legacy without modification.


<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L102-L106" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L102-L106</a></code>   
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L528-L608" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L528-L608</a></code>


## Configuration Settings

The Legacy_RenderSystem uses configuration settings from the legacyRender module, which can be managed through the admin interface:


<div class="table-wrapper">
<table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td>banners</td><td>Whether to activate banner ads</td></tr><tr><td>meta_keywords</td><td>SEO keywords for the site</td></tr><tr><td>meta_description</td><td>SEO description for the site</td></tr><tr><td>meta_robots</td><td>Robot directives for search engines</td></tr><tr><td>footer</td><td>Custom footer content</td></tr><tr><td>logotype</td><td>Site logo path</td></tr><tr><td>favicon</td><td>Site favicon path</td></tr></tbody></table>
</div>

## Delegates Extension Points

The rendering system provides several extension points through delegates:

<div class="table-wrapper">
<table><thead><tr><th>Delegate</th><th>Purpose</th></tr></thead><tbody><tr><td>Legacy_RenderSystem.SetupXoopsTpl</td><td>Allows customization of XoopsTpl setup</td></tr><tr><td>Legacy_RenderSystem.BeginRender</td><td>Called before rendering begins</td></tr></tbody></table>
</div>

<span class="iconify" data-icon="mdi:github"></span> Sources: <code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L144-L148" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L144-L148</a></code>   
<code><a href="https://github.com/xoopscube/legacy/blob/7f33bc98/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L310-L311" target="_blank">/html/modules/legacyRender/kernel/Legacy_RenderSystem.class.php#L310-L311</a></code>  


---

### Key Takeaways

The Legacy_RenderSystem is a central component of the XOOPSCube Legacy framework, responsible for transforming application data into HTML output through templates. It provides backward compatibility with XOOPS 2.x while offering modern features and extension points for customization. Understanding this system is crucial for theme developers and anyone working on the presentation layer of XOOPSCube applications.
